(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{162:function(e,t,r){"use strict";r.d(t,"d",(function(){return de})),r.d(t,"e",(function(){return he})),r.d(t,"a",(function(){return ue})),r.d(t,"c",(function(){return S.c}));var n=r(9),c=r(139),l=r.n(c),d=r(764),h=r(760),f=r(763),_=r(762),v=r(95),y=r(295),S=r(134),w=r(761),k=r(5),T=function(e){return window["_by_sensors_instance_".concat(e)]=function(){function e(e){if(!e)return!1;var t=Object.prototype.toString.call(e);return"[object Function]"==t||"[object AsyncFunction]"==t}function t(){return Date.now&&e(Date.now)?Date.now():(new Date).getTime()}function r(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)}function n(){if("function"==typeof Uint32Array){var e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),r(e)&&e.getRandomValues){var t=new Uint32Array(1);return e.getRandomValues(t)[0]/Math.pow(2,32)}}return Qe(1e19)/1e19}function i(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}function a(e,t){this.lockGetPrefix=e||"lock-get-prefix",this.lockSetPrefix=t||"lock-set-prefix"}function s(e){return"function"==typeof e||!(!e||"object"!=Object(k.a)(e))&&s(e.listener)}function c(){this._events={}}function l(e){var t=e;try{t=decodeURIComponent(e)}catch(r){t=e}return t}function u(e){for(var t={},r=(e=e||"").substring(1).split("&"),i=0;i<r.length;i++){var a=r[i].indexOf("=");if(-1!==a){var n=r[i].substring(0,a),s=r[i].substring(a+1);n=l(n),s=l(s),t[n]=s}}return t}function p(e){return"[object String]"==Object.prototype.toString.call(e)}function d(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function h(e){var t=function(e){this._fields={Username:4,Password:5,Port:7,Protocol:2,Host:6,Path:8,URL:0,QueryString:9,Fragment:10},this._values={},this._regex=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?(\w*)/,void 0!==e&&this._parse(e)};return t.prototype.setUrl=function(e){this._parse(e)},t.prototype._initValues=function(){for(var e in this._fields)this._values[e]=""},t.prototype.addQueryString=function(e){if("object"!=Object(k.a)(e))return!1;var t=this._values.QueryString||"";for(var r in e)t=new RegExp(r+"[^&]+").test(t)?t.replace(new RegExp(r+"[^&]+"),r+"="+e[r]):"&"===t.slice(-1)?t+r+"="+e[r]:""===t?r+"="+e[r]:t+"&"+r+"="+e[r];this._values.QueryString=t},t.prototype.getUrl=function(){var e="";return e+=this._values.Origin,e+=this._values.Port?":"+this._values.Port:"",e+=this._values.Path,(e+=this._values.QueryString?"?"+this._values.QueryString:"")+(this._values.Fragment?"#"+this._values.Fragment:"")},t.prototype._parse=function(e){this._initValues();var t=this._regex.exec(e);t||Ze.log("URLParser::_parse -> Invalid URL");var r=e.split("#"),n=r[0],i=r.slice(1).join("#");for(var a in t=this._regex.exec(n),this._fields)void 0!==t[this._fields[a]]&&(this._values[a]=t[this._fields[a]]);this._values.Hostname=this._values.Host.replace(/:\d+$/,""),this._values.Origin=this._values.Protocol+"://"+this._values.Hostname,this._values.Fragment=i},new t(e)}function f(e){var t={};if("function"==typeof window.URL&&function(){try{return"http://modernizr.com/"===new URL("http://modernizr.com/").href}catch(e){return!1}}())(t=new URL(e)).searchParams||(t.searchParams=function(){var e=u(t.search);return{get:function(t){return e[t]}}}());else{if(p(e)||(e=String(e)),e=d(e),!1===/^https?:\/\/.+/.test(e))return void Ze.log("Invalid URL");var i=h(e);t.hash=i._values.Fragment,t.host=i._values.Host?i._values.Host+(i._values.Port?":"+i._values.Port:""):"",t.href=i._values.URL,t.password=i._values.Password,t.pathname=i._values.Path,t.port=i._values.Port,t.search=i._values.QueryString?"?"+i._values.QueryString:"",t.username=i._values.Username,t.hostname=i._values.Hostname,t.protocol=i._values.Protocol?i._values.Protocol+":":"",t.origin=i._values.Origin?i._values.Origin+(i._values.Port?":"+i._values.Port:""):"",t.searchParams=function(){var e=u("?"+i._values.QueryString);return{get:function(t){return e[t]}}}()}return t}function _(e){return!(!e||1!==e.nodeType)}function g(e){return void 0===e}function v(t){return Array.isArray&&e(v)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function y(e){return new Ye(e)}function b(e,t,r,n){function i(e){return e&&(e.preventDefault=i.preventDefault,e.stopPropagation=i.stopPropagation,e._getPath=i._getPath),e}function a(e,t,r,n){return function(o){if(o=o||i(window.event)){o.target=o.srcElement;var c,s,l=!0;return"function"==typeof r&&(c=r(o)),s=t.call(e,o),"beforeunload"!==n?(!1!==c&&!1!==s||(l=!1),l):void 0}}}i._getPath=function(){return this.path||this.composedPath&&this.composedPath()||y(this.target).getParents()},i.preventDefault=function(){this.returnValue=!1},i.stopPropagation=function(){this.cancelBubble=!0};var o=function(e,t,r){if(void 0===n&&"click"===t&&(n=!0),e&&e.addEventListener)e.addEventListener(t,(function(e){e._getPath=i._getPath,r.call(this,e)}),n);else{var o="on"+t,s=e[o];e[o]=a(e,r,s,t)}};o.apply(null,arguments)}function S(e){var t="pushState"in window.history?"popstate":"hashchange";b(window,t,e)}function w(e){if(e)return void 0!==window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:null;if(void 0!==window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){Ze.log(e)}}}function T(e,t,r){if(null==e)return!1;if(br&&e.forEach===br)e.forEach(t,r);else if(v(e))for(var n=0,i=e.length;n<i;n++)n in e&&t.call(r,e[n],n,e);else for(var a in e)et.call(e,a)&&t.call(r,e[a],a,e)}function A(e){return T(Array.prototype.slice.call(arguments,1),(function(t){for(var r in t)tt.call(t,r)&&void 0!==t[r]&&(e[r]=t[r])})),e}function O(e){function t(e){if(!e)return"";try{return JSON.parse(e)}catch(e){return{}}}e.timeout=e.timeout||2e4,e.credentials=void 0===e.credentials||e.credentials;var i=w(e.cors);if(!i)return!1;e.type||(e.type=e.data?"POST":"GET");var a,n=(e=A({success:function(){},error:function(){}},e)).success,s=e.error;e.success=function(e){n(e),a&&(clearTimeout(a),a=null)},e.error=function(e){s(e),a&&(clearTimeout(a),a=null)},a=setTimeout((function(){!function(){try{i&&"object"==Object(k.a)(i)&&i.abort&&i.abort()}catch(e){Ze.log(e)}a&&(clearTimeout(a),a=null,e.error&&e.error(),i.onreadystatechange=null,i.onload=null,i.onerror=null)}()}),e.timeout),"undefined"!=typeof XDomainRequest&&i instanceof XDomainRequest&&(i.onload=function(){e.success&&e.success(t(i.responseText)),i.onreadystatechange=null,i.onload=null,i.onerror=null},i.onerror=function(){e.error&&e.error(t(i.responseText),i.status),i.onreadystatechange=null,i.onerror=null,i.onload=null}),i.onreadystatechange=function(){try{4==i.readyState&&(i.status>=200&&i.status<300||304==i.status?e.success(t(i.responseText)):e.error(t(i.responseText),i.status),i.onreadystatechange=null,i.onload=null)}catch(e){i.onreadystatechange=null,i.onload=null}},i.open(e.type,e.url,!0);try{e.credentials&&(i.withCredentials=!0),r(e.header)&&T(e.header,(function(e,t){i.setRequestHeader&&i.setRequestHeader(t,e)})),e.data&&(e.cors||i.setRequestHeader&&i.setRequestHeader("X-Requested-With","XMLHttpRequest"),"application/json"===e.contentType?i.setRequestHeader&&i.setRequestHeader("Content-type","application/json; charset=UTF-8"):i.setRequestHeader&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded"))}catch(e){Ze.log(e)}i.send(e.data||null)}function x(e,t){var r=[];return null==e?r:Array.prototype.map&&e.map===Array.prototype.map?e.map(t):(T(e,(function(e,n,i){r.push(t(e,n,i))})),r)}function j(e){var t=[];try{t=x(atob(e).split(""),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}))}catch(e){t=[]}try{return decodeURIComponent(t.join(""))}catch(e){return t.join("")}}function B(e){var t="";try{t=btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))}catch(r){t=e}return t}function P(e){return T(Array.prototype.slice.call(arguments,1),(function(t){for(var r in t)void 0!==t[r]&&void 0===e[r]&&(e[r]=t[r])})),e}function N(e){var t=e;try{t=decodeURI(e)}catch(r){t=e}return t}function D(e){var t="t6KJCZa5pDdQ9khoEM3Tj70fbP2eLSyc4BrsYugARqFIw1mzlGNVXOHiWvxUn8",r=t.length-1,n={},i=0;for(i=0;i<t.length;i++)n[t.charAt(i)]=t.charAt(r-i);var a="";for(i=0;i<e.length;i++)a+=e.charAt(i)in n?n[e.charAt(i)]:e.charAt(i);return a}function $(e){return"[object Date]"==Object.prototype.toString.call(e)}function C(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())}function E(e,t,r){var n=Object.prototype.hasOwnProperty;if(e.filter)return e.filter(t);for(var i=[],a=0;a<e.length;a++)if(n.call(e,a)){var o=e[a];t.call(r,o,a,e)&&i.push(o)}return i}function L(e){try{return JSON.stringify(e,null,"  ")}catch(t){return JSON.stringify(e)}}function q(e,t){t=t||"domain_test";var r=function(e){return"string"==typeof e&&e.match(/^[a-zA-Z0-9\u4e00-\u9fa5\-\.]+$/)?e:""}(e=e||location.hostname),n=r.split(".");if(v(n)&&n.length>=2&&!/^(\d+\.)+\d+$/.test(r))for(var i="."+n.splice(n.length-1,1);n.length>0;)if(i="."+n.splice(n.length-1,1)+i,document.cookie=t+"=true; path=/; domain="+i,-1!==document.cookie.indexOf(t+"=true")){var a=new Date;return a.setTime(a.getTime()-1e3),document.cookie=t+"=true; expires="+a.toGMTString()+"; path=/; SameSite=Lax; domain="+i,i}return""}function I(e,t){var r="",n="";return e.textContent?r=d(e.textContent):e.innerText&&(r=d(e.innerText)),r&&(r=r.replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)),n=r||"","input"!==t&&"INPUT"!==t||(n=e.value||""),n}function U(e,t){t&&"string"==typeof t||(t="hostname解析异常");var r=null;try{r=f(e).hostname}catch(e){Ze.log("getHostname传入的url参数不合法！")}return r||t}function R(){try{var e=navigator.appVersion.match(/OS (\d+)[._](\d+)[._]?(\d+)?/);return e&&e[1]?Number.parseInt(e[1],10):""}catch(e){return""}}function F(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=l(e);var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===i||i&&"string"!=typeof i[1]&&i[1].length?"":l(i[1])}function H(e){var t={},r=e.split("?")[1]||"";return r&&(t=u("?"+r)),t}function M(){return void 0!==window.matchMedia||void 0!==window.msMatchMedia}function J(){var e,t={},r=navigator.userAgent.toLowerCase();return(e=r.match(/ qq\/([\d.]+)/))?t.qqBuildinBrowser=Number(e[1].split(".")[0]):(e=r.match(/mqqbrowser\/([\d.]+)/))?t.qqBrowser=Number(e[1].split(".")[0]):(e=r.match(/opera.([\d.]+)/))?t.opera=Number(e[1].split(".")[0]):(e=r.match(/msie ([\d.]+)/))?t.ie=Number(e[1].split(".")[0]):(e=r.match(/edge.([\d.]+)/))?t.edge=Number(e[1].split(".")[0]):(e=r.match(/firefox\/([\d.]+)/))?t.firefox=Number(e[1].split(".")[0]):(e=r.match(/chrome\/([\d.]+)/))?t.chrome=Number(e[1].split(".")[0]):(e=r.match(/version\/([\d.]+).*safari/))?t.safari=Number(e[1].match(/^\d*.\d*/)):(e=r.match(/trident\/([\d.]+)/))&&(t.ie=11),t}function K(e){return p(e)?N(e=d(e)):N(location.href)}function V(e){return p(e)?N(e=d(e)):N(location.pathname)}function z(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0}function W(e,t){if("string"==typeof t)return z(e,t);if(v(t)){for(var r=!1,n=0;n<t.length;n++)if(z(e,t[n])){r=!0;break}return r}}function Z(e){if("string"!=typeof e)return 0;var t=0;if(0==e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}function Q(e){var t=9007199254740992,r=-9007199254740992,i=0;if(e.length>0)for(var a=e.split(""),n=0;n<a.length;n++){var s=a[n].charCodeAt(),o=31*i+s;if(o>t)for(i=r+i;(o=31*i+s)<r;)i=i/2+s;if(o<r)for(i=t+i;(o=31*i+s)>t;)i=i/2+s;i=31*i+s}return i}function X(e,t){var r=e.indexOf;if(r)return r.call(e,t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}function Y(e){return!(!e||!nt.call(e,"callee"))}function G(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function ee(e){if(r(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}function te(){return!!navigator.userAgent.match(/iPhone|iPad|iPod/i)}function re(e){try{JSON.parse(e)}catch(e){return!1}return!0}function ie(e){return"[object Number]"==Object.prototype.toString.call(e)&&/[\d\.]+/.test(String(e))}function ne(){var e=!1;if("object"!=("undefined"==typeof navigator?"undefined":Object(k.a)(navigator))||"function"!=typeof navigator.sendBeacon)return e;var t=J(),r=navigator.userAgent.toLowerCase();if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){var n=(r.match(/os [\d._]*/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,".").split(".");void 0===t.safari&&(t.safari=n[0]),n[0]&&(t.qqBuildinBrowser||t.qqBrowser)?e=!1:n[0]&&n[0]<13?(t.chrome>41||t.firefox>30||t.opera>25||t.safari>12)&&(e=!0):(t.chrome>41||t.firefox>30||t.opera>25||t.safari>11.3)&&(e=!0)}else(t.chrome>38||t.edge>13||t.firefox>30||t.opera>25||t.safari>11)&&(e=!0);return e}function ae(){return void 0!==window.XMLHttpRequest&&("withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest)}function se(e,t){t="number"==typeof t?t:13;for(var r=(e=String(e)).split(""),i=0,a=r.length;i<a;i++)r[i].charCodeAt(0)<126&&(r[i]=String.fromCharCode((r[i].charCodeAt(0)+t)%126));return r.join("")}function oe(e){return se(e=String(e),113)}function ce(e){r(e)&&T(e,(function(t,n){r(t)?ce(e[n]):$(t)&&(e[n]=C(t))}))}function le(e){var t=document.createElement("style");t.type="text/css";try{t.appendChild(document.createTextNode(e))}catch(r){t.styleSheet.cssText=e}var r=document.getElementsByTagName("head")[0],i=document.getElementsByTagName("script")[0];r?r.children.length?r.insertBefore(t,r.children[0]):r.appendChild(t):i.parentNode.insertBefore(t,i)}function ue(e){var t=[];return null==e||T(e,(function(e){t[t.length]=e})),t}function pe(){if((at.isSupport()&&"true"===sessionStorage.getItem("sensorsdata_jssdk_debug")||ut.show_log)&&(!r(arguments[0])||!0!==ut.show_log&&"string"!==ut.show_log&&!1!==ut.show_log||(arguments[0]=L(arguments[0])),"object"==("undefined"==typeof console?"undefined":Object(k.a)(console))&&console.log))try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}}function de(e){return!p(e)||0!==e.indexOf(pt)&&0!==e.indexOf(ht)||(e=function(e){return 0===e.indexOf(pt)?e=oe(e=e.substring(pt.length)):0===e.indexOf(ht)&&(e=D(e=e.substring(ht.length))),e}(e)),e}function he(e){return ht+D(e)}function fe(t){var n=t.properties,i=JSON.parse(JSON.stringify(t));r(n)&&T(n,(function(t,r){if(e(t))try{n[r]=t(i),e(n[r])&&(pe("您的属性- "+r+" 格式不满足要求，我们已经将其删除"),delete n[r])}catch(e){delete n[r],pe("您的属性- "+r+" 抛出了异常，我们已经将其删除")}}))}function _e(e){if("object"==Object(k.a)(e)&&e.$option){var t=e.$option;return delete e.$option,t}return{}}function ge(e){var t={};return T(e,(function(e,r){null!=e&&(t[r]=e)})),t}function me(e){var t=ut.current_domain;switch(Object(k.a)(t)){case"function":var r=t();return""===r||""===d(r)?"url解析失败":-1!==r.indexOf(".")?r:"url解析失败";case"string":return""===t||""===d(t)?"url解析失败":-1!==t.indexOf(".")?t:"url解析失败";default:var n=q(null,mt);return""===e||""===n?"url解析失败":n}}function ve(e){if(!e.target)return!1;var t=e.target,r=t.tagName.toLowerCase(),n={};return n.$element_type=r,n.$element_name=t.getAttribute("name"),n.$element_id=t.getAttribute("id"),n.$element_class_name="string"==typeof t.className?t.className:null,n.$element_target_url=t.getAttribute("href"),n.$element_content=je(t,r),(n=ge(n)).$url=K(),n.$url_path=V(),n.$title=document.title,n}function ye(){var e=document.referrer,t="baidu.com";if(!e)return!1;try{var r=f(e).hostname;return r&&r.substring(r.length-t.length)===t}catch(e){return!1}}function be(){var e=H(document.referrer);return ee(e)||!e.eqid?Xe().replace(/-/g,""):e.eqid}function Se(){var e=H(document.referrer);if(ee(e)||!e.eqid){var t=H(location.href);return e.ck||t.utm_source?"baidu_sem_keyword_id":"baidu_other_keyword_id"}return"baidu_seo_keyword_id"}function we(e){return""===(e=e||document.referrer)||q(U(e),mt)!==q(null,mt)}function ke(e,t){return"string"!=typeof(e=e||document.referrer)?"取值异常_referrer异常_"+String(e):(0!==(e=N(e=d(e))).indexOf("https://www.baidu.com/")||t||(e=e.split("?")[0]),"string"==typeof(e=e.slice(0,ut.max_referrer_string_length))?e:"")}function Te(e){var t=U(e);if(!t||"hostname解析异常"===t)return"";var r={baidu:[/^.*\.baidu\.com$/],bing:[/^.*\.bing\.com$/],google:[/^www\.google\.com$/,/^www\.google\.com\.[a-z]{2}$/,/^www\.google\.[a-z]{2}$/],sm:[/^m\.sm\.cn$/],so:[/^.+\.so\.com$/],sogou:[/^.*\.sogou\.com$/],yahoo:[/^.*\.yahoo\.com$/]};for(var n in r)for(var i=r[n],a=0,o=i.length;a<o;a++)if(i[a].test(t))return n;return"未知搜索引擎"}function Ae(e,t){e=e||document.referrer;var r=ut.source_type.keyword;if(document&&"string"==typeof e){if(0===e.indexOf("http")){var n=Te(e),i=H(e);if(ee(i))return ut.preset_properties.search_keyword_baidu&&ye()?void 0:"未取到值";var a=null;for(var o in r)if(n===o&&"object"==Object(k.a)(i))if(v(a=r[o]))for(o=0;o<a.length;o++){var s=i[a[o]];if(s)return t?{active:s}:s}else if(i[a])return t?{active:i[a]}:i[a];return ut.preset_properties.search_keyword_baidu&&ye()?void 0:"未取到值"}return""===e?"未取到值_直接打开":"未取到值_非http的url"}return"取值异常_referrer异常_"+String(e)}function Oe(e){var t=F(e,"gdt_vid"),r=F(e,"hash_key"),n=F(e,"callbacks"),i={click_id:"",hash_key:"",callbacks:""};return p(t)&&t.length&&(i.click_id=16==t.length||18==t.length?t:"参数解析不合法",p(r)&&r.length&&(i.hash_key=r),p(n)&&n.length&&(i.callbacks=n)),i}function xe(){function e(e,t){for(var r=0;r<e.length;r++)if(-1!==t.split("?")[0].indexOf(e[r]))return!0}var t="("+ut.source_type.utm.join("|")+")\\=[^&]+",r=ut.source_type.search,n=ut.source_type.social,i=document.referrer||"",a=bt.pageProp.url;if(a){var o=a.match(new RegExp(t));return o&&o[0]?"付费广告流量":e(r,i)?"自然搜索流量":e(n,i)?"社交网站流量":""===i?"直接流量":"引荐流量"}return"获取url异常"}function je(e,t){return p(t)&&"input"===t.toLowerCase()?function(e){var t=ut.heatmap&&"function"==typeof ut.heatmap.collect_input&&ut.heatmap.collect_input(e);return("button"===e.type||"submit"===e.type||t)&&e.value||""}(e):I(e,t)}function Be(e){return ft.protocol.ajax(e.url),O(e)}function Pe(e,t,n){var i=!(!r(ut.heatmap)||!ut.heatmap.useCapture);return r(ut.heatmap)&&void 0===ut.heatmap.useCapture&&"click"===t&&(i=!0),b(e,t,n,i)}function Ne(e,t){var r="";if(t=t||location.href,!1===ut.cross_subdomain){try{r=f(t).hostname}catch(e){pe(e)}r="string"==typeof r&&""!==r?"sajssdk_2015_"+ut.sdk_id+e+"_"+r.replace(/\./g,"_"):"sajssdk_2015_root_"+ut.sdk_id+e}else r="sajssdk_2015_cross_"+ut.sdk_id+e;return r}function De(){var e="new_user";return St.isSupport()?null!==St.get("sensorsdata_is_new_user")||null!==St.get(Ne(e)):null!==wt.get(wt.getNewUserFlagMemoryKey(e))}function $e(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!xt.check(r,e[r],t))return!1;return!0}function Ce(e){var t={};for(var r in e)t[r]=e[r];ze.store._state.identities=t,ze.store.save()}function Ee(e,t,r,n){var i=Tt.getFirstId()||Tt.getDistinctId();Tt.set("distinct_id",e),Bt.send({original_id:i,distinct_id:ze.store.getDistinctId(),type:"track_signup",event:t,properties:r},n)}function Le(e){var t=e.id,n=e.callback,i=e.name,a=Tt.getFirstId(),o=Tt.getOriginDistinctId();if(!Bt.check({distinct_id:t}))return ze.log("login id is invalid"),!1;if(t===ze.store.getOriginDistinctId()&&!a)return ze.log("login id is equal to distinct_id"),!1;if(r(ze.store._state.identities)&&ze.store._state.identities.hasOwnProperty(i)&&t===ze.store._state.first_id)return!1;if(ze.store._state.history_login_id.name!==i||t!==ze.store._state.history_login_id.value){ze.store._state.identities[i]=t,ze.store.set("history_login_id",{name:i,value:t}),a||Tt.set("first_id",o),Ee(t,"$SignUp",{},n);var c={$identity_cookie_id:ze.store._state.identities.$identity_cookie_id};return c[i]=t,Ce(c),!0}return!1}function Ie(t,r){"number"==typeof t&&(t=String(t)),!Le({id:t,callback:r,name:vt.LOGIN})&&e(r)&&r()}function Ue(e){return Ft.encodeTrackData(e)}function Re(e){switch(function(e){var t=["image","ajax","beacon"],r=t[0];return"beacon"===(r=e.config&&X(t,e.config.send_type)>-1?e.config.send_type:ze.para.send_type)&&!1===ne()&&(r="image"),"ajax"===r&&!1===ae()&&(r="image"),r}(e)){case"image":return new Ht(e);case"ajax":return new Mt(e);case"beacon":return new Jt(e);default:return new Ht(e)}}function Fe(){ze.readyState.setState(3),bt.initPage(),ze.para.is_track_single_page&&$t.on("switch",(function(e){var t=function(t){t=t||{},e!==location.href&&(bt.pageProp.referrer=K(e),ze.quick("autoTrack",A({$url:K(),$referrer:K(e)},t)))};if("boolean"==typeof ze.para.is_track_single_page)t();else if("function"==typeof ze.para.is_track_single_page){var n=ze.para.is_track_single_page();r(n)?t(n):!0===n&&t()}})),ze.store.init(),ze.readyState.setState(4),ze._q&&v(ze._q)&&ze._q.length>0&&T(ze._q,(function(e){ze[e[0]].apply(ze,Array.prototype.slice.call(e[1]))})),r(ze.para.heatmap)&&(Nt.initHeatmap(),Nt.initScrollmap())}function He(e){this.cancel=function(){e=!0},this.getCanceled=function(){return e||!1}}function Me(e,t,r){var n=null;try{n=JSON.parse(JSON.stringify(e||null))}catch(e){pe(e)}this.getOriginalData=function(){return n},this.getPosition=function(){return t},this.cancellationToken=new He,this.sensors=r}function Je(e){if(!r(e))throw"error: Stage constructor requires arguments.";this.processDef=e,this.registeredInterceptors={}}function qe(e){e&&e.dataStage&&zt.registerStageImplementation(e.dataStage),e&&e.businessStage&&Zt.registerStageImplementation(e.businessStage),e&&e.sendStage&&Wt.registerStageImplementation(e.sendStage)}function tr(t){return r(t)?(T(t,(function(r,n){if(v(r)){var i=[];T(r,(function(e){p(e)?i.push(e):pe("您的数据-",n,r,"的数组里的值必须是字符串,已经将其删除")})),t[n]=i}p(r)||ie(r)||$(r)||G(r)||v(r)||e(r)||"$option"===n||(pe("您的数据-",n,r,"-格式不满足要求，我们已经将其删除"),delete t[n])})),t):t}function Ke(e){var t=["$element_selector","$element_path"],n=["sensorsdata_app_visual_properties"];r(e)&&T(e,(function(i,a){if(r(i))Ke(e[a]);else if(p(i)){if(X(n,a)>-1)return;e[a]=function(e,t){return ie(t)&&e.length>t?(pe("字符串长度超过限制，已经做截取--"+e),e.slice(0,t)):e}(i,X(t,a)>-1?1024:ut.max_string_length)}}))}function Ve(e){var t=e.properties;r(t)?(tr(t),function(e){r(e)&&T(["distinct_id","user_id","id","date","datetime","event","events","first_id","original_id","device_id","properties","second_id","time","users"],(function(t,r){t in e&&(r<3?(delete e[t],pe("您的属性- "+t+"是保留字段，我们已经将其删除")):pe("您的属性- "+t+"是保留字段，请避免其作为属性名"))}))}(t),function(e){void 0!==e.properties.$project&&(e.project=e.properties.$project,delete e.properties.$project),void 0!==e.properties.$token&&(e.token=e.properties.$token,delete e.properties.$token)}(e),function(e){T(e,(function(t,r){$e({propertyKey:r},(function(t,n,i){return t||"keyLength"===i||delete e[r],!0}))}))}(t),Ke(t)):"properties"in e&&(e.properties={}),ce(e),function(e){"item_type"in e&&$e({item_type:e.item_type},(function(t){return t||delete e.item_type,!0})),"item_id"in e&&$e({item_id:e.item_id},(function(t,r,n){return t||"string"!==n||delete e.item_id,!0}))}(e)}var ze={};(function(){var e={function:!0,object:!0},t=e["undefined"==typeof window?"undefined":Object(k.a)(window)]&&window||this,r=t.JSON,i=t.JSON3,a=!1,n=function r(n,i){function a(e,t){try{e()}catch(e){t&&t()}}function o(e){if(null!=o[e])return o[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=o("json-stringify")&&o("date-serialization")&&o("json-parse");else if("date-serialization"==e){if(t=o("json-stringify")&&b){var r=i.stringify;a((function(){t='"-271821-04-20T00:00:00.000Z"'==r(new p(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==r(new p(864e13))&&'"-000001-01-01T00:00:00.000Z"'==r(new p(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==r(new p(-1))}))}}else{var n,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var u="function"==typeof(r=i.stringify);u&&((n=function(){return 1}).toJSON=n,a((function(){u="0"===r(0)&&"0"===r(new c)&&'""'==r(new l)&&r(v)===g&&r(g)===g&&r()===g&&"1"===r(n)&&"[1]"==r([n])&&"[null]"==r([g])&&"null"==r(null)&&"[null,null,null]"==r([g,v,null])&&r({a:[n,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===r(null,n)&&"[\n 1,\n 2\n]"==r([1,2],null,1)}),(function(){u=!1}))),t=u}if("json-parse"==e){var d,h=i.parse;"function"==typeof h&&a((function(){0!==h("0")||h(!1)||(n=h(s),(d=5==n.a.length&&1===n.a[0])&&(a((function(){d=!h('"\t"')})),d&&a((function(){d=1!==h("01")})),d&&a((function(){d=1!==h("1.")}))))}),(function(){d=!1})),t=d}}return o[e]=!!t}function s(e){return P(this)}n||(n=t.Object()),i||(i=t.Object());var c=n.Number||t.Number,l=n.String||t.String,u=n.Object||t.Object,p=n.Date||t.Date,d=n.SyntaxError||t.SyntaxError,h=n.TypeError||t.TypeError,f=n.Math||t.Math,_=n.JSON||t.JSON;if("object"==Object(k.a)(_)&&_)return i.stringify=_.stringify,i.parse=_.parse,i.runInContext=r,i;var g,m=u.prototype,v=m.toString,y=m.hasOwnProperty,b=new p(-0xc782b5b800cec);if(a((function(){b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()})),o["bug-string-char-index"]=o["date-serialization"]=o.json=o["json-stringify"]=o["json-parse"]=null,!o("json")){var S="[object Function]",w="[object Number]",T="[object String]",A="[object Array]",O=o("bug-string-char-index"),x=function(t,r){var n,i,a,o=0;for(a in(n=function(){this.valueOf=0}).prototype.valueOf=0,i=new n)y.call(i,a)&&o++;return n=i=null,o?x=function(e,t){var r,n,i=v.call(e)==S;for(r in e)i&&"prototype"==r||!y.call(e,r)||(n="constructor"===r)||t(r);(n||y.call(e,r="constructor"))&&t(r)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],x=function(t,r){var n,a,o=v.call(t)==S,s=!o&&"function"!=typeof t.constructor&&e[Object(k.a)(t.hasOwnProperty)]&&t.hasOwnProperty||y;for(n in t)o&&"prototype"==n||!s.call(t,n)||r(n);for(a=i.length;n=i[--a];)s.call(t,n)&&r(n)}),x(t,r)};if(!o("json-stringify")&&!o("date-serialization")){var j={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},B=function(e,t){return("000000"+(t||0)).slice(-e)},P=function(e){var t,r,n,i,a,o,s,c,l;if(b)t=function(e){r=e.getUTCFullYear(),n=e.getUTCMonth(),i=e.getUTCDate(),o=e.getUTCHours(),s=e.getUTCMinutes(),c=e.getUTCSeconds(),l=e.getUTCMilliseconds()};else{var u=f.floor,p=[0,31,59,90,120,151,181,212,243,273,304,334],d=function(e,t){return p[t]+365*(e-1970)+u((e-1969+(t=+(t>1)))/4)-u((e-1901+t)/100)+u((e-1601+t)/400)};t=function(e){for(i=u(e/864e5),r=u(i/365.2425)+1970-1;d(r+1,0)<=i;r++);for(n=u((i-d(r,0))/30.42);d(r,n+1)<=i;n++);i=1+i-d(r,n),o=u((a=(e%864e5+864e5)%864e5)/36e5)%24,s=u(a/6e4)%60,c=u(a/1e3)%60,l=a%1e3}}return(P=function(e){return e>-1/0&&e<1/0?(t(e),e=(r<=0||r>=1e4?(r<0?"-":"+")+B(6,r<0?-r:r):B(4,r))+"-"+B(2,n+1)+"-"+B(2,i)+"T"+B(2,o)+":"+B(2,s)+":"+B(2,c)+"."+B(3,l)+"Z",r=n=i=o=s=c=l=null):e=null,e})(e)};if(o("json-stringify")&&!o("date-serialization")){var N=i.stringify;i.stringify=function(e,t,r){var n=p.prototype.toJSON;p.prototype.toJSON=s;var i=N(e,t,r);return p.prototype.toJSON=n,i}}else{var D=function(e){var t=e.charCodeAt(0),r=j[t];return r||"\\u00"+B(2,t.toString(16))},$=/[\x00-\x1f\x22\x5c]/g,C=function(e){return $.lastIndex=0,'"'+($.test(e)?e.replace($,D):e)+'"'},E=function e(t,r,n,o,i,c,s){var l,d,u,f,_,m,y,S,b;if(a((function(){l=r[t]})),"object"==Object(k.a)(l)&&l&&(l.getUTCFullYear&&"[object Date]"==v.call(l)&&l.toJSON===p.prototype.toJSON?l=P(l):"function"==typeof l.toJSON&&(l=l.toJSON(t))),n&&(l=n.call(r,t,l)),l==g)return l===g?l:"null";switch("object"==(d=Object(k.a)(l))&&(u=v.call(l)),u||d){case"boolean":case"[object Boolean]":return""+l;case"number":case w:return l>-1/0&&l<1/0?""+l:"null";case"string":case T:return C(""+l)}if("object"==Object(k.a)(l)){for(y=s.length;y--;)if(s[y]===l)throw h();if(s.push(l),f=[],S=c,c+=i,u==A){for(m=0,y=l.length;m<y;m++)_=e(m,l,n,o,i,c,s),f.push(_===g?"null":_);b=f.length?i?"[\n"+c+f.join(",\n"+c)+"\n"+S+"]":"["+f.join(",")+"]":"[]"}else x(o||l,(function(t){var r=e(t,l,n,o,i,c,s);r!==g&&f.push(C(t)+":"+(i?" ":"")+r)})),b=f.length?i?"{\n"+c+f.join(",\n"+c)+"\n"+S+"}":"{"+f.join(",")+"}":"{}";return s.pop(),b}};i.stringify=function(t,r,n){var i,a,o,s;if(e[Object(k.a)(r)]&&r)if((s=v.call(r))==S)a=r;else if(s==A){o={};for(var c,l=0,u=r.length;l<u;)c=r[l++],"[object String]"!=(s=v.call(c))&&"[object Number]"!=s||(o[c]=1)}if(n)if((s=v.call(n))==w){if((n-=n%1)>0)for(n>10&&(n=10),i="";i.length<n;)i+=" "}else s==T&&(i=n.length<=10?n:n.slice(0,10));return E("",((c={})[""]=t,c),a,o,i,"",[])}}}if(!o("json-parse")){var L,q,I=l.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},R=function(){throw L=q=null,d()},F=function(){for(var e,t,r,n,i,a=q,o=a.length;L<o;)switch(i=a.charCodeAt(L)){case 9:case 10:case 13:case 32:L++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=O?a.charAt(L):a[L],L++,e;case 34:for(e="@",L++;L<o;)if((i=a.charCodeAt(L))<32)R();else if(92==i)switch(i=a.charCodeAt(++L)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=U[i],L++;break;case 117:for(t=++L,r=L+4;L<r;L++)(i=a.charCodeAt(L))>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||R();e+=I("0x"+a.slice(t,L));break;default:R()}else{if(34==i)break;for(i=a.charCodeAt(L),t=L;i>=32&&92!=i&&34!=i;)i=a.charCodeAt(++L);e+=a.slice(t,L)}if(34==a.charCodeAt(L))return L++,e;R();default:if(t=L,45==i&&(n=!0,i=a.charCodeAt(++L)),i>=48&&i<=57){for(48==i&&(i=a.charCodeAt(L+1))>=48&&i<=57&&R(),n=!1;L<o&&(i=a.charCodeAt(L))>=48&&i<=57;L++);if(46==a.charCodeAt(L)){for(r=++L;r<o&&!((i=a.charCodeAt(r))<48||i>57);r++);r==L&&R(),L=r}if(101==(i=a.charCodeAt(L))||69==i){for(43!=(i=a.charCodeAt(++L))&&45!=i||L++,r=L;r<o&&!((i=a.charCodeAt(r))<48||i>57);r++);r==L&&R(),L=r}return+a.slice(t,L)}n&&R();var s=a.slice(L,L+4);if("true"==s)return L+=4,!0;if("fals"==s&&101==a.charCodeAt(L+4))return L+=5,!1;if("null"==s)return L+=4,null;R()}return"$"},H=function(e,t,r){var n=M(e,t,r);n===g?delete e[t]:e[t]=n},M=function(e,t,r){var n,i=e[t];if("object"==Object(k.a)(i)&&i)if(v.call(i)==A)for(n=i.length;n--;)H(v,x,i);else x(i,(function(e){H(i,e,r)}));return r.call(e,t,i)};i.parse=function(e,t){var r,n;return L=0,q=""+e,r=function e(t){var r,n;if("$"==t&&R(),"string"==typeof t){if("@"==(O?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(r=[];"]"!=(t=F());)n?","==t?"]"==(t=F())&&R():R():n=!0,","==t&&R(),r.push(e(t));return r}if("{"==t){for(r={};"}"!=(t=F());)n?","==t?"}"==(t=F())&&R():R():n=!0,","!=t&&"string"==typeof t&&"@"==(O?t.charAt(0):t[0])&&":"==F()||R(),r[t.slice(1)]=e(F());return r}R()}return t}(F()),"$"!=F()&&R(),L=q=null,t&&v.call(t)==S?M(((n={})[""]=r,n),"",t):r}}}return i.runInContext=r,i}(t,t.JSON3={noConflict:function(){return a||(a=!0,t.JSON=r,t.JSON3=i,r=i=null),n}});t.JSON={parse:n.parse,stringify:n.stringify}}).call(window),function(e){if(e.atob)try{e.atob(" ")}catch(t){e.atob=function(e){var t=function(t){return e(String(t).replace(/[\t\n\f\r ]+/g,""))};return t.original=e,t}(e.atob)}else{var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;e.btoa=function(e){for(var r,n,i,a,o="",s=0,c=(e=String(e)).length%3;s<e.length;){if((n=e.charCodeAt(s++))>255||(i=e.charCodeAt(s++))>255||(a=e.charCodeAt(s++))>255)return"";o+=t.charAt((r=n<<16|i<<8|a)>>18&63)+t.charAt(r>>12&63)+t.charAt(r>>6&63)+t.charAt(63&r)}return c?o.slice(0,c-3)+"===".substring(c):o},e.atob=function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!r.test(e))return"";e+="==".slice(2-(3&e.length));for(var n,i,a,o="",s=0;s<e.length;)n=t.indexOf(e.charAt(s++))<<18|t.indexOf(e.charAt(s++))<<12|(i=t.indexOf(e.charAt(s++)))<<6|(a=t.indexOf(e.charAt(s++))),o+=64===i?String.fromCharCode(n>>16&255):64===a?String.fromCharCode(n>>16&255,n>>8&255):String.fromCharCode(n>>16&255,n>>8&255,255&n);return o}}}(window);var We,Ze={setup:function(e){We=e},log:function(){(We||console&&console.log||function(){}).apply(null,arguments)}},hr={get:function(e){return window.localStorage.getItem(e)},parse:function(e){var t;try{t=JSON.parse(hr.get(e))||null}catch(e){Ze.log(e)}return t},set:function(e,t){try{window.localStorage.setItem(e,t)}catch(e){Ze.log(e)}},remove:function(e){window.localStorage.removeItem(e)},isSupport:function(){var e=!0;try{var t="__local_store_support__",r="testIsSupportStorage";hr.set(t,r),hr.get(t)!==r&&(e=!1),hr.remove(t)}catch(t){e=!1}return e}},Qe=function(){var e=(new Date).getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();a.prototype.get=function(e,r,a,o){if(!e)throw new Error("key is must");r=r||1e4,a=a||1e3,o=o||function(){};var s=this.lockGetPrefix+e,c=hr.get(s),l=String(n());return c&&(c=i(c)||{randomNum:0,expireTime:0}).expireTime>t()?o(null):(hr.set(s,JSON.stringify({randomNum:l,expireTime:t()+r})),void setTimeout((function(){(c=i(hr.get(s))||{randomNum:0,expireTime:0})&&c.randomNum===l?(o(hr.get(e)),hr.remove(e),hr.remove(s)):o(null)}),a))},a.prototype.set=function(e,r,a,o,s){if(!e||!r)throw new Error("key and val is must");a=a||1e4,o=o||1e3,s=s||function(){};var c=this.lockSetPrefix+e,l=hr.get(c),u=String(n());return l&&(l=i(l)||{randomNum:0,expireTime:0}).expireTime>t()?s({status:"fail",reason:"This key is locked"}):(hr.set(c,JSON.stringify({randomNum:u,expireTime:t()+a})),void setTimeout((function(){(l=i(hr.get(c))||{randomNum:0,expireTime:0}).randomNum===u?hr.set(e,r)&&s({status:"success"}):s({status:"fail",reason:"This key is locked"})}),o))},c.prototype.on=function(e,t){if(!e||!t)return!1;if(!s(t))throw new Error("listener must be a function");this._events[e]=this._events[e]||[];var r="object"==Object(k.a)(t);return this._events[e].push(r?t:{listener:t,once:!1}),this},c.prototype.prepend=function(e,t){if(!e||!t)return!1;if(!s(t))throw new Error("listener must be a function");this._events[e]=this._events[e]||[];var r="object"==Object(k.a)(t);return this._events[e].unshift(r?t:{listener:t,once:!1}),this},c.prototype.prependOnce=function(e,t){return this.prepend(e,{listener:t,once:!0})},c.prototype.once=function(e,t){return this.on(e,{listener:t,once:!0})},c.prototype.off=function(e,t){var r=this._events[e];if(!r)return!1;if("number"==typeof t)r.splice(t,1);else if("function"==typeof t)for(var n=0,i=r.length;n<i;n++)r[n]&&r[n].listener===t&&r.splice(n,1);return this},c.prototype.emit=function(e,t){var r=this._events[e];if(!r)return!1;for(var n=0;n<r.length;n++){var i=r[n];i&&(i.listener.call(this,t||{}),i.once&&this.off(e,n))}return this},c.prototype.removeAllListeners=function(e){e&&this._events[e]?this._events[e]=[]:this._events={}},c.prototype.listeners=function(e){return e&&"string"==typeof e?this._events[e]:this._events};var Xe=function(){var e=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)};return function(){var i=String(screen.height*screen.width);i=i&&/\d{5,}/.test(i)?i.toString(16):String(31242*n()).replace(".","").slice(0,8);var a=e()+"-"+n().toString(16).replace(".","")+"-"+function(){function e(e,t){var r,n=0;for(r=0;r<t.length;r++)n|=i[r]<<8*r;return e^n}var t,r,n=navigator.userAgent,i=[],a=0;for(t=0;t<n.length;t++)r=n.charCodeAt(t),i.unshift(255&r),i.length>=4&&(a=e(a,i),i=[]);return i.length>0&&(a=e(a,i)),a.toString(16)}()+"-"+i+"-"+e();return a||(String(n())+String(n())+String(n())).slice(2,15)}}(),Ye=function(e){this.ele=e},Ge=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r};Ye.prototype={addClass:function(e){return-1===(" "+this.ele.className+" ").indexOf(" "+e+" ")&&(this.ele.className=this.ele.className+(""===this.ele.className?"":" ")+e),this},removeClass:function(e){var t=" "+this.ele.className+" ";return-1!==t.indexOf(" "+e+" ")&&(this.ele.className=t.replace(" "+e+" "," ").slice(1,-1)),this},hasClass:function(e){return-1!==(" "+this.ele.className+" ").indexOf(" "+e+" ")},attr:function(e,t){return"string"==typeof e&&g(t)?this.ele.getAttribute(e):("string"==typeof e&&(t=String(t),this.ele.setAttribute(e,t)),this)},offset:function(){var e=this.ele.getBoundingClientRect();if(e.width||e.height){var t=this.ele.ownerDocument.documentElement;return{top:e.top+window.pageYOffset-t.clientTop,left:e.left+window.pageXOffset-t.clientLeft}}return{top:0,left:0}},getSize:function(){if(!window.getComputedStyle)return{width:this.ele.offsetWidth,height:this.ele.offsetHeight};try{var e=this.ele.getBoundingClientRect();return{width:e.width,height:e.height}}catch(e){return{width:0,height:0}}},getStyle:function(e){return this.ele.currentStyle?this.ele.currentStyle[e]:this.ele.ownerDocument.defaultView.getComputedStyle(this.ele,null).getPropertyValue(e)},wrap:function(e){var t=document.createElement(e);return this.ele.parentNode.insertBefore(t,this.ele),t.appendChild(this.ele),y(t)},getCssStyle:function(e){var t=this.ele.style.getPropertyValue(e);if(t)return t;var r=null;if("function"==typeof window.getMatchedCSSRules&&(r=window.getMatchedCSSRules(this.ele)),!r||!v(r))return null;for(var n=r.length-1;n>=0;n--)if(t=r[n].style.getPropertyValue(e))return t},sibling:function(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e},next:function(){return this.sibling(this.ele,"nextSibling")},prev:function(){return this.sibling(this.ele,"previousSibling")},siblings:function(){return Ge((this.ele.parentNode||{}).firstChild,this.ele)},children:function(){return Ge(this.ele.firstChild)},parent:function(){var e=this.ele.parentNode;return y(e=e&&11!==e.nodeType?e:null)},previousElementSibling:function(){var e=this.ele;if("previousElementSibling"in document.documentElement)return y(e.previousElementSibling);for(;e=e.previousSibling;)if(1===e.nodeType)return y(e);return y(null)},getSameTypeSiblings:function(){for(var e=this.ele,t=e.parentNode,r=e.tagName.toLowerCase(),n=[],i=0;i<t.children.length;i++){var a=t.children[i];1===a.nodeType&&a.tagName.toLowerCase()===r&&n.push(t.children[i])}return n},getParents:function(){try{var e=this.ele;if(!_(e))return[];var t=[e];if(null===e||null===e.parentElement)return[];for(;null!==e.parentElement;)e=e.parentElement,t.push(e);return t}catch(e){return[]}}};var br=Array.prototype.forEach,et=Object.prototype.hasOwnProperty,tt=Object.prototype.hasOwnProperty,it={get:function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return l(i.substring(t.length,i.length))}return null},set:function(e,t,r,n,i,a,o){function s(e){return!!e&&e.replace(/\r\n/g,"")}var c=o,l="",u="",d="";if(0!==(r=null==r?73e3:r)){var h=new Date;"s"===String(r).slice(-1)?h.setTime(h.getTime()+1e3*Number(String(r).slice(0,-1))):h.setTime(h.getTime()+24*r*60*60*1e3),l="; expires="+h.toGMTString()}p(i)&&""!==i&&(d="; SameSite="+i),a&&(u="; secure");var f="",_="",g="";e&&(f=s(e)),t&&(_=s(t)),c&&(g=s(c)),f&&_&&(document.cookie=f+"="+encodeURIComponent(_)+l+"; path=/"+g+d+u)},remove:function(e,t){this.set(e,"1",-1,t)},isSupport:function(e,t){e=e||"cookie_support_test",t=t||"1";var r=this;return navigator.cookieEnabled&&(r.set(e,t),r.get(e)===t&&(r.remove(e),!0))}},nt=Object.prototype.hasOwnProperty,at={isSupport:function(){var e=!0,t="__session_storage_support__",r="testIsSupportStorage";try{sessionStorage&&sessionStorage.setItem?(sessionStorage.setItem(t,r),sessionStorage.removeItem(t,r),e=!0):e=!1}catch(t){e=!1}return e}},st={"+":"-","/":"_","=":"."},ot={"-":"+",_:"/",".":"="},ct={encode:function(e){return e.replace(/[+\/=]/g,(function(e){return st[e]}))},decode:function(e){return e.replace(/[-_.]/g,(function(e){return ot[e]}))},trim:function(e){return e.replace(/[.=]{1,2}$/,"")},isBase64:function(e){return/^[A-Za-z0-9+\/]*[=]{0,2}$/.test(e)},isUrlSafeBase64:function(e){return/^[A-Za-z0-9_-]*[.]{0,2}$/.test(e)}},lt={__proto__:null,ConcurrentStorage:a,EventEmitter:c,URL:f,UUID:Xe,addEvent:b,addHashEvent:S,ajax:O,base64Decode:j,base64Encode:B,bindReady:function(e,t){t=t||window;var r=!1,n=!0,i=t.document,a=i.documentElement,o=i.addEventListener,s=o?"addEventListener":"attachEvent",c=o?"removeEventListener":"detachEvent",l=o?"":"on",u=function u(n){"readystatechange"==n.type&&"complete"!=i.readyState||(("load"==n.type?t:i)[c](l+n.type,u,!1),!r&&(r=!0)&&e.call(t,n.type||n))};if("complete"==i.readyState)e.call(t,"lazy");else{if(!o&&a.doScroll){try{n=!t.frameElement}catch(e){Ze.log(e)}n&&function p(){try{a.doScroll("left")}catch(e){return void setTimeout(p,50)}u("poll")}()}i[s](l+"DOMContentLoaded",u,!1),i[s](l+"readystatechange",u,!1),t[s](l+"load",u,!1)}},cookie:it,coverExtend:P,decodeURI:N,decodeURIComponent:l,dfmapping:D,each:T,encodeDates:function e(t){return T(t,(function(n,o){$(n)?t[o]=C(n):r(n)&&(t[o]=e(n))})),t},extend:A,extend2Lev:function(e){return T(Array.prototype.slice.call(arguments,1),(function(t){for(var n in t)void 0!==t[n]&&(r(t[n])&&r(e[n])?A(e[n],t[n]):e[n]=t[n])})),e},filter:E,formatDate:C,formatJsonString:L,getCookieTopLevelDomain:q,getDomBySelector:function(e){if(!p(e))return null;var i,t=e.split(">");return(i=function e(r){var i,a=t.shift();if(!a)return r;try{i=function(e,t){var r;if("body"===(e=d(e)))return document.getElementsByTagName("body")[0];if(0===e.indexOf("#"))e=e.slice(1),r=document.getElementById(e);else if(e.indexOf(":nth-of-type")>-1){var n=e.split(":nth-of-type");if(!n[0]||!n[1])return null;var i=n[0],a=n[1].match(/\(([0-9]+)\)/);if(!a||!a[1])return null;var o=Number(a[1]);if(!(_(t)&&t.children&&t.children.length>0))return null;for(var s=t.children,c=0;c<s.length;c++)if(_(s[c])&&s[c].tagName.toLowerCase()===i&&0==--o){r=s[c];break}if(o>0)return null}return r||null}(a,r)}catch(e){Ze.log(e)}return i&&_(i)?e(i):null}())&&_(i)?i:null},getElementContent:I,getHostname:U,getIOSVersion:R,getQueryParam:F,getQueryParamsFromUrl:H,getRandom:n,getRandomBasic:Qe,getScreenOrientation:function(){var e=screen.msOrientation||screen.mozOrientation||(screen.orientation||{}).type,t="未取到值";if(e)t=e.indexOf("landscape")>-1?"landscape":"portrait";else if(M()){var r=window.matchMedia||window.msMatchMedia;r("(orientation: landscape)").matches?t="landscape":r("(orientation: portrait)").matches&&(t="portrait")}return t},getUA:J,getURL:K,getURLPath:V,getURLSearchParams:u,hasAttribute:z,hasAttributes:W,hashCode:Z,hashCode53:Q,indexOf:X,inherit:function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},isArguments:Y,isArray:v,isBoolean:G,isDate:$,isElement:_,isEmptyObject:ee,isFunction:e,isHttpUrl:function(e){return"string"==typeof e&&(!1!==/^https?:\/\/.+/.test(e)||(Ze.log("Invalid URL"),!1))},isIOS:te,isJSONString:re,isNumber:ie,isObject:r,isString:p,isSupportBeaconSend:ne,isSupportCors:ae,isUndefined:g,jsonp:function(t){if(!r(t)||!p(t.callbackName))return Ze.log("JSONP 请求缺少 callbackName"),!1;t.success=e(t.success)?t.success:function(){},t.error=e(t.error)?t.error:function(){},t.data=t.data||"";var n=document.createElement("script"),i=document.getElementsByTagName("head")[0],a=null,o=!1;if(i.appendChild(n),ie(t.timeout)&&(a=setTimeout((function(){return!o&&(t.error("timeout"),window[t.callbackName]=function(){Ze.log("call jsonp error")},a=null,i.removeChild(n),void(o=!0))}),t.timeout)),window[t.callbackName]=function(){clearTimeout(a),a=null,t.success.apply(null,arguments),window[t.callbackName]=function(){Ze.log("call jsonp error")},i.removeChild(n)},t.url.indexOf("?")>-1?t.url+="&callbackName="+t.callbackName:t.url+="?callbackName="+t.callbackName,r(t.data)){var s=[];T(t.data,(function(e,t){s.push(t+"="+e)})),t.data=s.join("&"),t.url+="&"+t.data}n.onerror=function(e){return!o&&(window[t.callbackName]=function(){Ze.log("call jsonp error")},clearTimeout(a),a=null,i.removeChild(n),t.error(e),void(o=!0))},n.src=t.url},listenPageState:function(t){({visibleHandler:e(t.visible)?t.visible:function(){},hiddenHandler:e(t.hidden)?t.hidden:function(){},visibilityChange:null,hidden:null,isSupport:function(){return void 0!==document[this.hidden]},init:function(){void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen:function(){if(this.isSupport()){var e=this;b(document,this.visibilityChange,(function(){document[e.hidden]?e.hiddenHandler():e.visibleHandler()}),1)}else b(window,"focus",this.visibleHandler),b(window,"blur",this.hiddenHandler)}}).init()},loadScript:function(e){e=A({success:function(){},error:function(){},appendCall:function(e){document.getElementsByTagName("head")[0].appendChild(e)}},e);var t=null;"css"===e.type&&((t=document.createElement("link")).rel="stylesheet",t.href=e.url),"js"===e.type&&((t=document.createElement("script")).async="async",t.setAttribute("charset","UTF-8"),t.src=e.url,t.type="text/javascript"),t.onload=t.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e.success(),t.onload=t.onreadystatechange=null)},t.onerror=function(){e.error(),t.onerror=null},e.appendCall(t)},localStorage:hr,logger:Ze,map:x,mediaQueriesSupported:M,now:t,removeScriptProtocol:function(e){if("string"!=typeof e)return"";for(var t=/^\s*javascript/i;t.test(e);)e=e.replace(t,"");return e},rot13defs:oe,rot13obfs:se,ry:y,safeJSONParse:i,searchObjDate:ce,sessionStorage:at,setCssStyle:le,strToUnicode:function(e){if("string"!=typeof e)return Ze.log("转换unicode错误",e),e;for(var t="",r=0;r<e.length;r++)t+="\\"+e.charCodeAt(r).toString(16);return t},throttle:function(e,r,n){var i,a,o,s=null,c=0;n||(n={});var l=function(){c=!1===n.leading?0:t(),s=null,o=e.apply(i,a),s||(i=a=null)};return function(){var u=t();c||!1!==n.leading||(c=u);var p=r-(u-c);return i=this,a=arguments,p<=0||p>r?(s&&(clearTimeout(s),s=null),c=u,o=e.apply(i,a),s||(i=a=null)):s||!1===n.trailing||(s=setTimeout(l,p)),o}},toArray:function(e){return e?e.toArray?e.toArray():v(e)||Y(e)?Array.prototype.slice.call(e):ue(e):[]},trim:d,unique:function(e){for(var t,r=[],n={},i=0;i<e.length;i++)(t=e[i])in n||(n[t]=!0,r.push(t));return r},urlParse:h,urlSafeBase64:ct,values:ue,xhr:w},ut={},pt="data:enc;",ht="dfm-enc-",ft={distinct_id:function(){},jssdkDebug:function(){},_sendDebug:function(e){},apph5:function(e){var t="app_h5打通失败-",n={1:t+"use_app_track为false",2:t+"Android或者iOS，没有暴露相应方法",3.1:t+"Android校验server_url失败",3.2:t+"iOS校验server_url失败",4.1:t+"H5 校验 iOS server_url 失败",4.2:t+"H5 校验 Android server_url 失败"},i=e.output,a=e.step,o=e.data||"";"all"!==i&&"console"!==i||pe(n[a]),("all"===i||"code"===i)&&r(ut.is_debug)&&ut.is_debug.apph5&&(o.type&&"profile"===o.type.slice(0,7)||(o.properties._jssdk_debug_info="apph5-"+String(a)))},defineMode:function(e){var t={1:{title:"当前页面无法进行可视化全埋点",message:"App SDK 与 Web JS SDK 没有进行打通，请联系贵方技术人员修正 App SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_link-1573913.html"},2:{title:"当前页面无法进行可视化全埋点",message:"App SDK 与 Web JS SDK 没有进行打通，请联系贵方技术人员修正 Web JS SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_link-1573913.html"},3:{title:"当前页面无法进行可视化全埋点",message:"Web JS SDK 没有开启全埋点配置，请联系贵方工作人员修正 SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_web_all-1573964.html"},4:{title:"当前页面无法进行可视化全埋点",message:"Web JS SDK 配置的数据校验地址与 App SDK 配置的数据校验地址不一致，请联系贵方工作人员修正 SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_link-1573913.html"}};return!(!e||!t[e])&&t[e]},protocol:{protocolIsSame:function(e,t){try{if(f(e).protocol!==f(t).protocol)return!1}catch(e){return pe("不支持 _.URL 方法"),!1}return!0},serverUrl:function(){p(ut.server_url)&&""!==ut.server_url&&!this.protocolIsSame(ut.server_url,location.href)&&pe("SDK 检测到您的数据发送地址和当前页面地址的协议不一致，建议您修改成一致的协议。\n因为：1、https 下面发送 http 的图片请求会失败。2、http 页面使用 https + ajax 方式发数据，在 ie9 及以下会丢失数据。")},ajax:function(e){return e!==ut.server_url&&void(p(e)&&""!==e&&!this.protocolIsSame(e,location.href)&&pe("SDK 检测到您的数据发送地址和当前页面地址的协议不一致，建议您修改成一致的协议。因为 http 页面使用 https + ajax 方式发数据，在 ie9 及以下会丢失数据。"))}}},_t="utm_source utm_medium utm_campaign utm_content utm_term",gt="1.23.4",mt="sensorsdata_domain_test",vt={EMAIL:"$identity_email",MOBILE:"$identity_mobile",LOGIN:"$identity_login_id"},yt={data:{},id:function(){return this.data.id||(this.data.id=be()),this.data.id},type:function(){return this.data.type||(this.data.type=Se()),this.data.type}},bt={initPage:function(){var e=ke(),t=K(),r=me(t);r||ft.jssdkDebug("url_domain异常_"+t+"_"+r),this.pageProp={referrer:e,referrer_host:e?U(e):"",url:t,url_host:U(t,"url_host取值异常"),url_domain:r}},pageProp:{},campaignParams:function(){return ze.kit.getUtmData()},campaignParamsStandard:function(e,t){e=e||"",t=t||"";var r=bt.campaignParams(),n={},i={};return T(r,(function(r,a,o){-1!==(" "+_t+" ").indexOf(" "+a+" ")?n[e+a]=o[a]:i[t+a]=o[a]})),{$utms:n,otherUtms:i}},properties:function(){var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0;return{$timezone_offset:(new Date).getTimezoneOffset(),$screen_height:Number(screen.height)||0,$screen_width:Number(screen.width)||0,$viewport_height:e,$viewport_width:t,$lib:"js",$lib_version:gt}},currentProps:{},register:function(e){A(bt.currentProps,e)}},St={get:function(e){return it.get(e)},set:function(e,t,r,n){var i="";if(n=void 0===n?ut.cross_subdomain:n){var a=me(location.href);"url解析失败"===a&&(a=""),i=a?"; domain="+a:""}return it.set(e,t,r,n,ut.set_cookie_samesite,ut.is_secure_cookie,i)},remove:function(e,t){return t=void 0===t?ut.cross_subdomain:t,it.remove(e,t)},isSupport:function(e,t){return e=e||"sajssdk_2015_cookie_access_test",t=t||"1",it.isSupport(e,t)}};St.getNewUser=De;var wt={data:{},get:function(e){var t=this.data[e];return void 0===t?null:void 0!==t._expirationTimestamp_?(new Date).getTime()>t._expirationTimestamp_?null:t.value:t},set:function(e,t,r){if(r){var i=new Date;t={value:t,_expirationTimestamp_:"s"===String(r).slice(-1)?i.getTime()+1e3*Number(String(r).slice(0,-1)):i.getTime()+24*r*60*60*1e3}}this.data[e]=t},getNewUserFlagMemoryKey:function(e){return"sajssdk_2015_"+ut.sdk_id+e}},kt={checkIsAddSign:function(e){"track"===e.type&&(De()?e.properties.$is_first_day=!0:e.properties.$is_first_day=!1)},is_first_visit_time:!1,is_page_first_visited:!1,checkIsFirstTime:function(e){"track"===e.type&&"$pageview"===e.event&&(this.is_first_visit_time?(e.properties.$is_first_time=!0,this.is_first_visit_time=!1):e.properties.$is_first_time=!1)},setDeviceId:function(e){var t=null,r=St.get("sensorsdata2015jssdkcross"+ze.para.sdk_id),n={};null!=(r=de(r))&&re(r)&&(n=JSON.parse(r)).$device_id&&(t=n.$device_id),t=t||e,!0===ze.para.cross_subdomain?ze.store.set("$device_id",t):(n.$device_id=t,n=JSON.stringify(n),ze.para.encrypt_cookie&&(n=he(n)),St.set("sensorsdata2015jssdkcross"+ze.para.sdk_id,n,null,!0)),ze.para.is_track_device_id&&(bt.currentProps.$device_id=t)},storeInitCheck:function(){if(ze.is_first_visitor){var e=new Date,t={h:23-e.getHours(),m:59-e.getMinutes(),s:59-e.getSeconds()};St.isSupport()?St.set(Ne("new_user"),"1",3600*t.h+60*t.m+t.s+"s"):wt.set(wt.getNewUserFlagMemoryKey("new_user"),"1",3600*t.h+60*t.m+t.s+"s"),this.is_first_visit_time=!0,this.is_page_first_visited=!0}else De()||(this.checkIsAddSign=function(e){"track"===e.type&&(e.properties.$is_first_day=!1)}),this.checkIsFirstTime=function(e){"track"===e.type&&"$pageview"===e.event&&(e.properties.$is_first_time=!1)}},checkIsFirstLatest:function(){var e=bt.pageProp.url_domain,t={};""===e&&(e="url解析失败");var n=Ae(document.referrer,!0);if(ze.para.preset_properties.search_keyword_baidu?we(document.referrer)&&(!ye()||r(n)&&n.active?ze.store._state&&ze.store._state.props&&(ze.store._state.props.$search_keyword_id&&delete ze.store._state.props.$search_keyword_id,ze.store._state.props.$search_keyword_id_type&&delete ze.store._state.props.$search_keyword_id_type,ze.store._state.props.$search_keyword_id_hash&&delete ze.store._state.props.$search_keyword_id_hash):(t.$search_keyword_id=yt.id(),t.$search_keyword_id_type=yt.type(),t.$search_keyword_id_hash=Q(t.$search_keyword_id))):ze.store._state&&ze.store._state.props&&(ze.store._state.props.$search_keyword_id&&delete ze.store._state.props.$search_keyword_id,ze.store._state.props.$search_keyword_id_type&&delete ze.store._state.props.$search_keyword_id_type,ze.store._state.props.$search_keyword_id_hash&&delete ze.store._state.props.$search_keyword_id_hash),ze.store.save(),T(ze.para.preset_properties,(function(n,i){if(-1===i.indexOf("latest_"))return!1;if(i=i.slice(7),n){if("wx_ad_click_id"===i&&"not_collect"===n)return!1;if("utm"!==i&&"url解析失败"===e)"wx_ad_click_id"===i?(t._latest_wx_ad_click_id="url的domain解析失败",t._latest_wx_ad_hash_key="url的domain解析失败",t._latest_wx_ad_callbacks="url的domain解析失败"):t["$latest_"+i]="url的domain解析失败";else if(we(document.referrer))switch(i){case"traffic_source_type":t.$latest_traffic_source_type=xe();break;case"referrer":t.$latest_referrer=bt.pageProp.referrer;break;case"search_keyword":Ae()?t.$latest_search_keyword=Ae():r(ze.store._state)&&r(ze.store._state.props)&&ze.store._state.props.$latest_search_keyword&&delete ze.store._state.props.$latest_search_keyword;break;case"landing_page":t.$latest_landing_page=K();break;case"wx_ad_click_id":var a=Oe(location.href);t._latest_wx_ad_click_id=a.click_id,t._latest_wx_ad_hash_key=a.hash_key,t._latest_wx_ad_callbacks=a.callbacks}}else if("utm"===i&&ze.store._state&&ze.store._state.props)for(var o in ze.store._state.props)(0===o.indexOf("$latest_utm")||0===o.indexOf("_latest_")&&o.indexOf("_latest_wx_ad_")<0)&&delete ze.store._state.props[o];else ze.store._state&&ze.store._state.props&&"$latest_"+i in ze.store._state.props?delete ze.store._state.props["$latest_"+i]:"wx_ad_click_id"==i&&ze.store._state&&ze.store._state.props&&!1===n&&T(["_latest_wx_ad_click_id","_latest_wx_ad_hash_key","_latest_wx_ad_callbacks"],(function(e){e in ze.store._state.props&&delete ze.store._state.props[e]}))})),ze.register(t),ze.para.preset_properties.latest_utm){var i=bt.campaignParamsStandard("$latest_","_latest_"),a=i.$utms,o=i.otherUtms;ee(a)||ze.register(a),ee(o)||ze.register(o)}}},Tt={requests:[],_sessionState:{},_state:{distinct_id:"",first_id:"",props:{},identities:{}},getProps:function(){return this._state.props||{}},getSessionProps:function(){return this._sessionState},getOriginDistinctId:function(){return this._state._distinct_id||this._state.distinct_id},getOriginUnionId:function(e){var t={},r=(e=e||this._state)._first_id||e.first_id,n=e._distinct_id||e.distinct_id;return r&&n?(t.login_id=n,t.anonymous_id=r):t.anonymous_id=n,t},getDistinctId:function(){var e=this.getUnionId();return e.login_id||e.anonymous_id},getUnionId:function(e){var t=this.getOriginUnionId(e);return t.login_id&&this._state.history_login_id&&this._state.history_login_id.name&&this._state.history_login_id.name!==ze.IDENTITY_KEY.LOGIN&&(t.login_id=this._state.history_login_id.name+"+"+t.login_id),t},getFirstId:function(){return this._state._first_id||this._state.first_id},initSessionState:function(){var e=St.get("sensorsdata2015session"),t=null;null!==(e=de(e))&&"object"==Object(k.a)(t=i(e))&&(this._sessionState=t||{})},setOnce:function(e,t){e in this._state||this.set(e,t)},set:function(e,t){this._state=this._state||{};var r=this._state.distinct_id;this._state[e]=t,"first_id"===e?delete this._state._first_id:"distinct_id"===e&&delete this._state._distinct_id,this.save(),"distinct_id"===e&&r&&ze.events.tempAdd("changeDistinctId",t)},change:function(e,t){this._state["_"+e]=t},setSessionProps:function(e){var t=this._sessionState;A(t,e),this.sessionSave(t)},setSessionPropsOnce:function(e){var t=this._sessionState;P(t,e),this.sessionSave(t)},setProps:function(e,t){var r={};for(var n in r=t?e:A(this._state.props||{},e))"string"==typeof r[n]&&(r[n]=r[n].slice(0,ze.para.max_referrer_string_length));this.set("props",r)},setPropsOnce:function(e){var t=this._state.props||{};P(t,e),this.set("props",t)},clearAllProps:function(e){var t;if(this._sessionState={},v(e)&&e.length>0)for(t=0;t<e.length;t++)p(e[t])&&-1===e[t].indexOf("latest_")&&r(this._state.props)&&e[t]in this._state.props&&delete this._state.props[e[t]];else if(r(this._state.props))for(t in this._state.props)1!==t.indexOf("latest_")&&delete this._state.props[t];this.sessionSave({}),this.save()},sessionSave:function(e){this._sessionState=e;var t=JSON.stringify(this._sessionState);ze.para.encrypt_cookie&&(t=he(t)),St.set("sensorsdata2015session",t,0)},save:function(){var e=JSON.parse(JSON.stringify(this._state));delete e._first_id,delete e._distinct_id,e.identities&&(e.identities=B(JSON.stringify(e.identities)));var t=JSON.stringify(e);ze.para.encrypt_cookie&&(t=he(t)),St.set(this.getCookieName(),t,73e3,ze.para.cross_subdomain)},getCookieName:function(){var e="";if(!1===ze.para.cross_subdomain){try{e=f(location.href).hostname}catch(e){ze.log(e)}e="string"==typeof e&&""!==e?"sa_jssdk_2015_"+ze.para.sdk_id+e.replace(/\./g,"_"):"sa_jssdk_2015_root"+ze.para.sdk_id}else e="sensorsdata2015jssdkcross"+ze.para.sdk_id;return e},init:function(){this.initSessionState();var e,a,t=Xe();St.isSupport()&&(a=i(e=de(e=St.get(this.getCookieName())))),St.isSupport()&&null!==e&&re(e)&&r(a)&&(!r(a)||a.distinct_id)?(ze.store._state=A(function(e){var t;e.identities&&(0===e.identities.indexOf("\n/")?e.identities=i(oe(e.identities)):e.identities=i(j(e.identities)));var n=Tt.getOriginUnionId(e);e.identities&&r(e.identities)&&!ee(e.identities)?e.identities.$identity_anonymous_id&&e.identities.$identity_anonymous_id!==n.anonymous_id&&(e.identities.$identity_anonymous_id=n.anonymous_id):(e.identities={},e.identities.$identity_anonymous_id=n.anonymous_id,e.identities.$identity_cookie_id=Xe()),e.history_login_id=e.history_login_id||{};var o=e.history_login_id.name;if(n.login_id)if(o&&e.identities.hasOwnProperty(o)){if(e.identities[o]!==n.login_id){for(t in e.identities[o]=n.login_id,e.identities)e.identities.hasOwnProperty(t)&&"$identity_cookie_id"!==t&&t!==o&&delete e.identities[t];e.history_login_id.value=n.login_id}}else{var s=o||ze.IDENTITY_KEY.LOGIN;for(t in e.identities[s]=n.login_id,e.identities)e.identities.hasOwnProperty(t)&&"$identity_cookie_id"!==t&&t!==s&&delete e.identities[t];e.history_login_id={name:s,value:n.login_id}}else{if(e.identities.hasOwnProperty("$identity_login_id")||e.identities.hasOwnProperty(o))for(t in e.identities)e.identities.hasOwnProperty(t)&&"$identity_cookie_id"!==t&&"$identity_anonymous_id"!==t&&delete e.identities[t];e.history_login_id={name:"",value:""}}return e}(a)),ze.store.save()):(ze.is_first_visitor=!0,function(e){ze.store.set("distinct_id",e),ze.store.set("identities",{$identity_cookie_id:e}),ze.store.set("history_login_id",{name:"",value:""})}(t)),kt.setDeviceId(t),kt.storeInitCheck(),kt.checkIsFirstLatest()},saveObjectVal:function(e,t){p(t)||(t=JSON.stringify(t)),1==ze.para.encrypt_cookie&&(t=he(t)),hr.set(e,t)},readObjectVal:function(e){var t=hr.get(e);return t?i(t=de(t)):null}},At={string:function(e){pe(e+" must be string")},emptyString:function(e){pe(e+"'s is empty")},regexTest:function(e){pe(e+" is invalid")},idLength:function(e){pe(e+" length is longer than "+ut.max_id_length)},keyLength:function(e){pe(e+" length is longer than "+ut.max_key_length)},stringLength:function(e){pe(e+" length is longer than "+ut.max_string_length)},voidZero:function(e){pe(e+"'s is undefined")},reservedLoginId:function(e){pe(e+" is invalid")},reservedBind:function(e){pe(e+" is invalid")},reservedUnbind:function(e){pe(e+" is invalid")}},Ot={regName:/^((?!^distinct_id$|^original_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_tag.*|^user_group.*)[a-zA-Z_$][a-zA-Z\d_$]*)$/i,loginIDReservedNames:["$identity_anonymous_id","$identity_cookie_id"],bindReservedNames:["$identity_login_id","$identity_anonymous_id","$identity_cookie_id"],unbindReservedNames:["$identity_anonymous_id",vt.LOGIN],string:function(e){return!!p(e)},emptyString:function(e){return!(!p(e)||0===d(e).length)},regexTest:function(e){return!(!p(e)||!this.regName.test(e))},idLength:function(e){return!(!p(e)||e.length>ut.max_id_length)},keyLength:function(e){return!(!p(e)||e.length>ut.max_key_length)},stringLength:function(e){return!(!p(e)||e.length>ut.max_string_length)},voidZero:function(e){return void 0!==e},reservedLoginId:function(e){return!(X(this.loginIDReservedNames,e)>-1)},reservedUnbind:function(e){return!(X(this.unbindReservedNames,e)>-1)},reservedBind:function(e){var t=Tt._state.history_login_id;return!(t&&t.name&&t.name===e||X(this.bindReservedNames,e)>-1)}},xt={distinct_id:{rules:["string","emptyString","idLength"],onComplete:function(t,r,n){return!t&&("emptyString"===n&&(r="Id"),e(At[n])&&At[n](r),"idLength"===n)||t}},event:{rules:["string","emptyString","keyLength","regexTest"],onComplete:function(t,r,n){return t||("emptyString"===n&&(r="eventName"),e(At[n])&&At[n](r)),!0}},propertyKey:{rules:["string","emptyString","keyLength","regexTest"],onComplete:function(t,r,n){return t||("emptyString"===n&&(r="Property key"),e(At[n])&&At[n](r)),!0}},propertyValue:{rules:["voidZero"],onComplete:function(t,r,n){return t||e(At[n])&&At[n]("Property Value"),!0}},properties:function(t){return r(t)?T(t,(function(t,r){$e({propertyKey:r}),$e({propertyValue:t},(function(t,n,i){return t||(n=r+"'s Value",e(At[i])&&At[i](n)),!0}))})):Ot.voidZero(t)&&pe("properties可以没有，但有的话必须是对象"),!0},propertiesMust:function(e){return void 0!==e&&r(e)&&!ee(e)?this.properties.call(this,e):pe("properties必须是对象"),!0},item_type:{rules:["string","emptyString","keyLength","regexTest"],onComplete:function(t,r,n){return t||("emptyString"===n&&(r="item_type"),e(At[n])&&At[n](r)),!0}},item_id:{rules:["string","emptyString","stringLength"],onComplete:function(t,r,n){return t||("emptyString"===n&&(r="item_id"),e(At[n])&&At[n](r)),!0}},loginIdKey:{rules:["string","emptyString","keyLength","regexTest","reservedLoginId"],onComplete:function(t,r,n){return!t&&("emptyString"===n&&(r="login_id_key"),e(At[n])&&At[n](r),"keyLength"===n)||t}},bindKey:{rules:["string","emptyString","keyLength","regexTest","reservedBind"],onComplete:function(t,r,n){return!t&&("emptyString"===n&&(r="Key"),e(At[n])&&At[n](r),"keyLength"===n)||t}},unbindKey:{rules:["string","emptyString","keyLength","regexTest","reservedUnbind"],onComplete:function(t,r,n){return!t&&("emptyString"===n&&(r="Key"),e(At[n])&&At[n](r),"keyLength"===n)||t}},bindValue:{rules:["string","emptyString","idLength"],onComplete:function(t,r,n){return!t&&("emptyString"===n&&(r="Value"),e(At[n])&&At[n](r),"idLength"===n)||t}},check:function(t,r,n){var i=this[t];if(e(i))return i.call(this,r);if(!i)return!1;for(var a=0;a<i.rules.length;a++){var o=i.rules[a],s=Ot[o](r),c=e(n)?n(s,r,o):i.onComplete(s,r,o);if(!s)return c}return!0}},jt={stage:null,init:function(e){this.stage=e}},Bt={};Bt.check=$e,Bt.sendItem=function(e){var t={lib:{$lib:"js",$lib_method:"code",$lib_version:String(ze.lib_version)},time:1*new Date};A(t,e),jt.stage.process("formatData",t),ze.sendState.getSendCall(t)},Bt.send=function(e,t){var r=ze.kit.buildData(e);ze.kit.sendData(r,t)},Bt.debugPath=function(e){var t=e;Be({url:-1!==ze.para.debug_mode_url.indexOf("?")?ze.para.debug_mode_url+"&"+ze.kit.encodeTrackData(e):ze.para.debug_mode_url+"?"+ze.kit.encodeTrackData(e),type:"GET",cors:!0,header:{"Dry-Run":String(ze.para.debug_mode_upload)},success:function(e){!0===ee(e)?alert("debug数据发送成功"+t):alert("debug失败 错误原因"+JSON.stringify(e))}})};var Pt={label:!1,li:!1,a:!0,button:!0},Nt={otherTags:[],initUnlimitedTags:function(){T(Nt.otherTags,(function(e){e in Pt&&(Pt[e]=!0)}))},isUnlimitedTag:function(e){if(!e||1!==e.nodeType)return!1;var t=e.nodeName.toLowerCase();return Pt[t]||W(e,ze.para.heatmap.track_attr)},getTargetElement:function(e,t){var r=this,n=e;if("object"!=Object(k.a)(n))return null;if("string"!=typeof n.tagName)return null;var i=n.tagName.toLowerCase();if("body"===i.toLowerCase()||"html"===i.toLowerCase())return null;if(!n||!n.parentNode||!n.parentNode.children)return null;var a=n.parentNode,o=r.otherTags;if("a"===i||"button"===i||"input"===i||"textarea"===i)return n;if(X(o,i)>-1)return n;if("area"===i&&"map"===a.tagName.toLowerCase()&&y(a).prev().tagName&&"img"===y(a).prev().tagName.toLowerCase())return y(a).prev();if("div"===i&&ze.para.heatmap.collect_tags.div&&r.isDivLevelValid(n)&&((ze.para.heatmap&&ze.para.heatmap.collect_tags&&ze.para.heatmap.collect_tags.div&&ze.para.heatmap.collect_tags.div.max_level||1)>1||r.isCollectableDiv(n)))return n;if(r.isStyleTag(i)&&ze.para.heatmap.collect_tags.div){var c=r.getCollectableParent(n);if(c&&r.isDivLevelValid(c))return c}return r.hasElement({event:t&&t.originalEvent||t,element:e},(function(e){return r.isUnlimitedTag(e)}))||null},getDivLevels:function(e,t){var r=Nt.getElementPath(e,!0,t).split(" > "),i=0;return T(r,(function(e){"div"===e&&i++})),i},isDivLevelValid:function(e){for(var t=ze.para.heatmap&&ze.para.heatmap.collect_tags&&ze.para.heatmap.collect_tags.div&&ze.para.heatmap.collect_tags.div.max_level||1,r=e.getElementsByTagName("div"),n=r.length-1;n>=0;n--)if(Nt.getDivLevels(r[n],e)>t)return!1;return!0},getElementPath:function(e,t,r){for(var n=[];e.parentNode;){if(e.id&&!t&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(e.id)){n.unshift(e.tagName.toLowerCase()+"#"+e.id);break}if(r&&e===r){n.unshift(e.tagName.toLowerCase());break}if(e===document.body){n.unshift("body");break}n.unshift(e.tagName.toLowerCase()),e=e.parentNode}return n.join(" > ")},getClosestLi:function(e){return function(e,t){for(;e&&e!==document&&1===e.nodeType;e=e.parentNode)if(e.tagName.toLowerCase()===t)return e;return null}(e,"li")},getElementPosition:function(e,t,r){var i=ze.heatmap.getClosestLi(e);if(!i)return null;var a=e.tagName.toLowerCase(),n=i.getElementsByTagName(a),s=n.length,o=[];if(s>1){for(var c=0;c<s;c++)ze.heatmap.getElementPath(n[c],r)===t&&o.push(n[c]);if(o.length>1)return X(o,e)}return function(e){if(!e.parentNode)return"";if(1===y(e).getSameTypeSiblings().length)return 0;for(var i=0,a=e;y(a).previousElementSibling().ele;a=y(a).previousElementSibling().ele,i++);return i}(i)},setNotice:function(e){ze.is_heatmap_render_mode=!0,ze.para.heatmap||(ze.errorMsg="您SDK没有配置开启点击图，可能没有数据！"),e&&"http:"===e.slice(0,5)&&"https:"===location.protocol&&(ze.errorMsg="您的当前页面是https的地址，神策分析环境也必须是https！"),ze.para.heatmap_url||(ze.para.heatmap_url=function(){var e=location.protocol;return"http:"===e||"https:"===e?e:"http:"}()+"//static.sensorsdata.cn/sdk/"+ze.lib_version+"/heatmap.min.js")},getDomIndex:function(e){if(!e.parentNode)return-1;for(var t=0,r=e.tagName,n=e.parentNode.children,i=0;i<n.length;i++)if(n[i].tagName===r){if(e===n[i])return t;t++}return-1},selector:function(e,t){var r=e.parentNode&&9==e.parentNode.nodeType?-1:this.getDomIndex(e);return e.getAttribute&&e.getAttribute("id")&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(e.getAttribute("id"))&&(!ze.para.heatmap||ze.para.heatmap&&"not_use_id"!==ze.para.heatmap.element_selector)&&!t?"#"+e.getAttribute("id"):e.tagName.toLowerCase()+(~r?":nth-of-type("+(r+1)+")":"")},getDomSelector:function(e,t,r){if(!e||!e.parentNode||!e.parentNode.children)return!1;t=t&&t.join?t:[];var n=e.nodeName.toLowerCase();return e&&"body"!==n&&1==e.nodeType?(t.unshift(this.selector(e,r)),e.getAttribute&&e.getAttribute("id")&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(e.getAttribute("id"))&&ze.para.heatmap&&"not_use_id"!==ze.para.heatmap.element_selector&&!r?t.join(" > "):this.getDomSelector(e.parentNode,t,r)):(t.unshift("body"),t.join(" > "))},na:function(){var e=document.documentElement.scrollLeft||window.pageXOffset;return parseInt(isNaN(e)?0:e,10)},i:function(){var e=0;try{e=o.documentElement&&o.documentElement.scrollTop||m.pageYOffset,e=isNaN(e)?0:e}catch(t){e=0}return parseInt(e,10)},getBrowserWidth:function(){var e=window.innerWidth||document.body.clientWidth;return isNaN(e)?0:parseInt(e,10)},getBrowserHeight:function(){var e=window.innerHeight||document.body.clientHeight;return isNaN(e)?0:parseInt(e,10)},getScrollWidth:function(){var e=parseInt(document.body.scrollWidth,10);return isNaN(e)?0:e},getEleDetail:function(e){var t=this.getDomSelector(e),r=ve({target:e});r.$element_selector=t||"",r.$element_path=ze.heatmap.getElementPath(e,ze.para.heatmap&&"not_use_id"===ze.para.heatmap.element_selector);var n=ze.heatmap.getElementPosition(e,r.$element_path,ze.para.heatmap&&"not_use_id"===ze.para.heatmap.element_selector);return ie(n)&&(r.$element_position=n),r},getPointerEventProp:function(e,t){function r(){return{scrollLeft:document.body.scrollLeft||document.documentElement.scrollLeft||0,scrollTop:document.body.scrollTop||document.documentElement.scrollTop||0}}function n(e){if(document.documentElement.getBoundingClientRect){var t=e.getBoundingClientRect();return{targetEleX:t.left+r().scrollLeft||0,targetEleY:t.top+r().scrollTop||0}}}function i(e){return Number(Number(e).toFixed(3))}return e?function(e){var a=e.pageX||e.clientX+r().scrollLeft||e.offsetX+n(t).targetEleX||0,o=e.pageY||e.clientY+r().scrollTop||e.offsetY+n(t).targetEleY||0;return{$page_x:i(a),$page_y:i(o)}}(e):{}},start:function(t,n,i,a,o){var s=r(a)?a:{},c=e(o)?o:e(a)?a:void 0;if(ze.para.heatmap&&ze.para.heatmap.collect_element&&!ze.para.heatmap.collect_element(n))return!1;var l=this.getEleDetail(n);if(ze.para.heatmap&&ze.para.heatmap.custom_property){var u=ze.para.heatmap.custom_property(n);r(u)&&(l=A(l,u))}l=A(l,this.getPointerEventProp(t,n),s),"a"===i&&ze.para.heatmap&&!0===ze.para.heatmap.isTrackLink?ze.trackLink({event:t,target:n},"$WebClick",l):ze.track("$WebClick",l,c)},hasElement:function(e,t){var r;if(e.event){var n=e.event;r=n.path||n._getPath&&n._getPath()}else e.element&&(r=y(e.element).getParents());if(r&&v(r)&&r.length>0)for(var i=0;i<r.length;i++)if("object"==Object(k.a)(r[i])&&1===r[i].nodeType&&t(r[i]))return r[i]},isStyleTag:function(e,t){return!(X(["a","div","input","button","textarea"],e)>-1)&&(!t||ze.para.heatmap&&ze.para.heatmap.collect_tags&&ze.para.heatmap.collect_tags.div?!!(r(ze.para.heatmap)&&r(ze.para.heatmap.collect_tags)&&r(ze.para.heatmap.collect_tags.div)&&v(ze.para.heatmap.collect_tags.div.ignore_tags)&&X(ze.para.heatmap.collect_tags.div.ignore_tags,e)>-1):X(["mark","/mark","strong","b","em","i","u","abbr","ins","del","s","sup"],e)>-1)},isCollectableDiv:function(e,t){try{if(0===e.children.length)return!0;for(var r=0;r<e.children.length;r++)if(1===e.children[r].nodeType){var n=e.children[r].tagName.toLowerCase(),i=ze.para&&ze.para.heatmap&&ze.para.heatmap.collect_tags&&ze.para.heatmap.collect_tags.div&&ze.para.heatmap.collect_tags.div.max_level;if(!("div"===n&&i>1||this.isStyleTag(n,t)))return!1;if(!this.isCollectableDiv(e.children[r],t))return!1}return!0}catch(e){ze.log(e)}return!1},getCollectableParent:function(e,t){try{var r=e.parentNode,n=r?r.tagName.toLowerCase():"";if("body"===n)return!1;var i=ze.para&&ze.para.heatmap&&ze.para.heatmap.collect_tags&&ze.para.heatmap.collect_tags.div&&ze.para.heatmap.collect_tags.div.max_level;if(n&&"div"===n&&(i>1||this.isCollectableDiv(r,t)))return r;if(r&&this.isStyleTag(n,t))return this.getCollectableParent(r,t)}catch(e){ze.log(e)}return!1},listenUrlChange:function(e){e(),ze.ee.spa.on("switch",(function(){e()}))},initScrollmap:function(){if(!r(ze.para.heatmap)||"default"!==ze.para.heatmap.scroll_notice_map)return!1;var t=!0;ze.para.scrollmap&&e(ze.para.scrollmap.collect_url)&&this.listenUrlChange((function(){t=!!ze.para.scrollmap.collect_url()}));var i=function(e){var t={};return t.timeout=e.timeout||1e3,t.func=e.func,t.hasInit=!1,t.inter=null,t.main=function(e,t){this.func(e,t),this.inter=null},t.go=function(e){var r={};this.inter||(r.$viewport_position=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,r.$viewport_position=Math.round(r.$viewport_position)||0,e?t.main(r,!0):this.inter=setTimeout((function(){t.main(r)}),this.timeout))},t}({timeout:1e3,func:function(e,t){var r=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,n=new Date,i=n-this.current_time;(i>ze.para.heatmap.scroll_delay_time&&r-e.$viewport_position!=0||t)&&(e.$url=K(),e.$title=document.title,e.$url_path=V(),e.event_duration=Math.min(ze.para.heatmap.scroll_event_duration,parseInt(i)/1e3),e.event_duration=e.event_duration<0?0:e.event_duration,ze.track("$WebStay",e)),this.current_time=n}});i.current_time=new Date,Pe(window,"scroll",(function(){return!!t&&void i.go()})),Pe(window,"unload",(function(){return!!t&&void i.go("notime")}))},initHeatmap:function(){var t=this,n=!0;return!(!r(ze.para.heatmap)||"default"!==ze.para.heatmap.clickmap)&&(e(ze.para.heatmap.collect_url)&&this.listenUrlChange((function(){n=!!ze.para.heatmap.collect_url()})),"all"===ze.para.heatmap.collect_elements?ze.para.heatmap.collect_elements="all":ze.para.heatmap.collect_elements="interact",void("all"===ze.para.heatmap.collect_elements?Pe(document,"click",(function(e){if(!n)return!1;var r=e||window.event;if(!r)return!1;var i=r.target||r.srcElement;if("object"!=Object(k.a)(i))return!1;if("string"!=typeof i.tagName)return!1;var a=i.tagName.toLowerCase();if("body"===a||"html"===a)return!1;if(!i||!i.parentNode||!i.parentNode.children)return!1;var o=i.parentNode.tagName.toLowerCase();"a"===o||"button"===o?t.start(r,i.parentNode,o):t.start(r,i,a)})):Pe(document,"click",(function(e){if(!n)return!1;var i=e||window.event;if(!i)return!1;var a=i.target||i.srcElement,o=ze.heatmap.getTargetElement(a,e);o?t.start(i,o,o.tagName.toLowerCase()):_(a)&&"div"===a.tagName.toLowerCase()&&r(ze.para.heatmap)&&ze.para.heatmap.get_vtrack_config&&ze.unlimitedDiv.events.length>0&&ze.unlimitedDiv.isTargetEle(a)&&t.start(i,a,a.tagName.toLowerCase(),{$lib_method:"vtrack"})}))))}},Dt={setOnlineState:function(e){if(!0===e&&r(ze.para.jsapp)&&"function"==typeof ze.para.jsapp.getData){ze.para.jsapp.isOnline=!0;var t=ze.para.jsapp.getData();v(t)&&t.length>0&&T(t,(function(e){re(e)&&ze.sendState.realtimeSend(JSON.parse(e))}))}else ze.para.jsapp.isOnline=!1},autoTrackIsUsed:!1,isReady:function(e){e()},getUtm:function(){return bt.campaignParams()},getStayTime:function(){return(new Date-ze._t)/1e3},setProfileLocal:function(e){if(!hr.isSupport())return ze.setProfile(e),!1;if(!r(e)||ee(e))return!1;var t=ze.store.readObjectVal("sensorsdata_2015_jssdk_profile"),n=!1;if(r(t)&&!ee(t)){for(var i in e)(!(i in t)||t[i]===e[i])&&i in t||(t[i]=e[i],n=!0);n&&(ze.store.saveObjectVal("sensorsdata_2015_jssdk_profile",t),ze.setProfile(e))}else ze.store.saveObjectVal("sensorsdata_2015_jssdk_profile",e),ze.setProfile(e)},setInitReferrer:function(){var e=ke();ze.setOnceProfile({_init_referrer:e,_init_referrer_host:bt.pageProp.referrer_host})},setSessionReferrer:function(){var e=ke();ze.store.setSessionPropsOnce({_session_referrer:e,_session_referrer_host:bt.pageProp.referrer_host})},setDefaultAttr:function(){bt.register({_current_url:location.href,_referrer:ke(),_referring_host:bt.pageProp.referrer_host})},trackHeatMap:function(e,t,r){if("object"==Object(k.a)(e)&&e.tagName){var n=e.tagName.toLowerCase(),i=e.parentNode.tagName.toLowerCase(),a=ze.para.heatmap&&ze.para.heatmap.track_attr?ze.para.heatmap.track_attr:["data-sensors-click"];"button"===n||"a"===n||"a"===i||"button"===i||"input"===n||"textarea"===n||W(e,a)||Nt.start(null,e,n,t,r)}},trackAllHeatMap:function(e,t,r){if("object"==Object(k.a)(e)&&e.tagName){var n=e.tagName.toLowerCase();Nt.start(null,e,n,t,r)}},autoTrackSinglePage:function(e,t){function n(){var e=bt.campaignParams(),t={};return T(e,(function(e,r,n){-1!==(" "+ze.source_channel_standard+" ").indexOf(" "+r+" ")?t["$"+r]=n[r]:t[r]=n[r]})),t}function i(e,t){ze.track("$pageview",A({$referrer:a,$url:K(),$url_path:V(),$title:document.title},e,n()),t),a=K()}var a;a=this.autoTrackIsUsed?bt.pageProp.url:bt.pageProp.referrer;var o=!(e=r(e)?e:{}).not_set_profile;if(e.not_set_profile&&delete e.not_set_profile,i(e,t),this.autoTrackSinglePage=i,ze.is_first_visitor&&o){var s={};ze.para.preset_properties.search_keyword_baidu&&we(document.referrer)&&ye()&&(s.$search_keyword_id=yt.id(),s.$search_keyword_id_type=yt.type(),s.$search_keyword_id_hash=Q(s.$search_keyword_id)),ze.setOnceProfile(A({$first_visit_time:new Date,$first_referrer:ke(),$first_browser_language:p(navigator.language)?navigator.language.toLowerCase():"取值异常",$first_browser_charset:"string"==typeof document.charset?document.charset.toUpperCase():"取值异常",$first_traffic_source_type:xe(),$first_search_keyword:Ae()},n(),s)),ze.is_first_visitor=!1}},autoTrackWithoutProfile:function(e,t){e=r(e)?e:{},this.autoTrack(A(e,{not_set_profile:!0}),t)},autoTrack:function(e,t){e=r(e)?e:{};var n=bt.campaignParams(),i={};T(n,(function(e,t,r){-1!==(" "+ze.source_channel_standard+" ").indexOf(" "+t+" ")?i["$"+t]=r[t]:i[t]=r[t]}));var a=!e.not_set_profile;e.not_set_profile&&delete e.not_set_profile;var o=location.href;if(ze.para.is_single_page&&S((function(){var r=ke(o,!0);ze.track("$pageview",A({$referrer:r,$url:K(),$url_path:V(),$title:document.title},i,e),t),o=K()})),ze.track("$pageview",A({$referrer:ke(null,!0),$url:K(),$url_path:V(),$title:document.title},i,e),t),ze.is_first_visitor&&a){var s={};ze.para.preset_properties.search_keyword_baidu&&we(document.referrer)&&ye()&&(s.$search_keyword_id=yt.id(),s.$search_keyword_id_type=yt.type(),s.$search_keyword_id_hash=Q(s.$search_keyword_id)),ze.setOnceProfile(A({$first_visit_time:new Date,$first_referrer:ke(null,!0),$first_browser_language:p(navigator.language)?navigator.language.toLowerCase():"取值异常",$first_browser_charset:"string"==typeof document.charset?document.charset.toUpperCase():"取值异常",$first_traffic_source_type:xe(),$first_search_keyword:Ae()},i,s)),ze.is_first_visitor=!1}this.autoTrackIsUsed=!0},getAnonymousID:function(){return ee(ze.store._state)?"请先初始化SDK":ze.store._state._first_id||ze.store._state.first_id||ze.store._state._distinct_id||ze.store._state.distinct_id},setPlugin:function(t){return!!r(t)&&void T(t,(function(t,n){e(t)&&(r(window.SensorsDataWebJSSDKPlugin)&&window.SensorsDataWebJSSDKPlugin[n]?t(window.SensorsDataWebJSSDKPlugin[n]):ze.log(n+"没有获取到,请查阅文档，调整"+n+"的引入顺序！"))}))},useModulePlugin:function(){ze.use.apply(ze,arguments)},useAppPlugin:function(){this.setPlugin.apply(this,arguments)}},$t=new c,Ct=new c,Et={};Et.spa=$t,Et.sdk=Ct,Et.initSystemEvent=function(){!function(t){var a,r=location.href,n=window.history.pushState,i=window.history.replaceState;e(window.history.pushState)&&(window.history.pushState=function(){n.apply(window.history,arguments),t(r),r=location.href}),e(window.history.replaceState)&&(window.history.replaceState=function(){i.apply(window.history,arguments),t(r),r=location.href}),a=window.document.documentMode?"hashchange":n?"popstate":"hashchange",b(window,a,(function(){t(r),r=location.href}))}((function(e){$t.emit("switch",e)}))},Et.EVENT_LIST={spaSwitch:["spa","switch"],sdkAfterInitPara:["sdk","afterInitPara"],sdkBeforeInit:["sdk","beforeInit"],sdkAfterInit:["sdk","afterInit"]};var Lt={__proto__:null,addReferrerHost:function(e){var t=!e.type||"profile"!==e.type.slice(0,7),n="取值异常";r(e.properties)&&(e.properties.$first_referrer&&(e.properties.$first_referrer_host=U(e.properties.$first_referrer,n)),t&&("$referrer"in e.properties&&(e.properties.$referrer_host=""===e.properties.$referrer?"":U(e.properties.$referrer,n)),ze.para.preset_properties.latest_referrer&&ze.para.preset_properties.latest_referrer_host&&(e.properties.$latest_referrer_host=""===e.properties.$latest_referrer?"":U(e.properties.$latest_referrer,n))))},addPropsHook:function(e){var t=!e.type||"profile"!==e.type.slice(0,7),r=ze.para.preset_properties&&t;r&&ze.para.preset_properties.url&&void 0===e.properties.$url&&(e.properties.$url=K()),r&&ze.para.preset_properties.title&&void 0===e.properties.$title&&(e.properties.$title=document.title)},initPara:function(e){A(ut,e||ze.para||{}),ze.para=ut;var i,t={};if(r(ze.para.is_track_latest))for(var n in ze.para.is_track_latest)t["latest_"+n]=ze.para.is_track_latest[n];for(i in ze.para.preset_properties=A({},ze.para_default.preset_properties,t,ze.para.preset_properties||{}),ze.para_default)void 0===ze.para[i]&&(ze.para[i]=ze.para_default[i]);"string"==typeof ze.para.server_url&&(ze.para.server_url=d(ze.para.server_url),ze.para.server_url&&("://"===ze.para.server_url.slice(0,3)?ze.para.server_url=location.protocol.slice(0,-1)+ze.para.server_url:"//"===ze.para.server_url.slice(0,2)?ze.para.server_url=location.protocol+ze.para.server_url:"http"!==ze.para.server_url.slice(0,4)&&(ze.para.server_url=""))),"string"!=typeof ze.para.web_url||"://"!==ze.para.web_url.slice(0,3)&&"//"!==ze.para.web_url.slice(0,2)||("://"===ze.para.web_url.slice(0,3)?ze.para.web_url=location.protocol.slice(0,-1)+ze.para.web_url:ze.para.web_url=location.protocol+ze.para.web_url),"image"!==ze.para.send_type&&"ajax"!==ze.para.send_type&&"beacon"!==ze.para.send_type&&(ze.para.send_type="image"),ze.debug.protocol.serverUrl(),ze.bridge.initPara();var a={datasend_timeout:6e3,send_interval:6e3};hr.isSupport()&&ae()&&"object"==("undefined"==typeof localStorage?"undefined":Object(k.a)(localStorage))?!0===ze.para.batch_send?ze.para.batch_send=A({},a):"object"==Object(k.a)(ze.para.batch_send)&&(ze.para.batch_send=A({},a,ze.para.batch_send)):ze.para.batch_send=!1;var o=["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],s=["www.baidu.","m.baidu.","m.sm.cn","so.com","sogou.com","youdao.com","google.","yahoo.com/","bing.com/","ask.com/"],c=["weibo.com","renren.com","kaixin001.com","douban.com","qzone.qq.com","zhihu.com","tieba.baidu.com","weixin.qq.com"],l={baidu:["wd","word","kw","keyword"],google:"q",bing:"q",yahoo:"p",sogou:["query","keyword"],so:"q",sm:"q"};"object"==Object(k.a)(ze.para.source_type)&&(ze.para.source_type.utm=v(ze.para.source_type.utm)?ze.para.source_type.utm.concat(o):o,ze.para.source_type.search=v(ze.para.source_type.search)?ze.para.source_type.search.concat(s):s,ze.para.source_type.social=v(ze.para.source_type.social)?ze.para.source_type.social.concat(c):c,ze.para.source_type.keyword=r(ze.para.source_type.keyword)?A(l,ze.para.source_type.keyword):l);var p=["mark","/mark","strong","b","em","i","u","abbr","ins","del","s","sup"];if(ze.para.heatmap&&!r(ze.para.heatmap)&&(ze.para.heatmap={}),r(ze.para.heatmap)){ze.para.heatmap.clickmap=ze.para.heatmap.clickmap||"default",ze.para.heatmap.scroll_notice_map=ze.para.heatmap.scroll_notice_map||"default",ze.para.heatmap.scroll_delay_time=ze.para.heatmap.scroll_delay_time||4e3,ze.para.heatmap.scroll_event_duration=ze.para.heatmap.scroll_event_duration||18e3,ze.para.heatmap.renderRefreshTime=ze.para.heatmap.renderRefreshTime||1e3,ze.para.heatmap.loadTimeout=ze.para.heatmap.loadTimeout||1e3,!0!==ze.para.heatmap.get_vtrack_config&&(ze.para.heatmap.get_vtrack_config=!1);var h=v(ze.para.heatmap.track_attr)?E(ze.para.heatmap.track_attr,(function(e){return e&&"string"==typeof e})):[];h.push("data-sensors-click"),ze.para.heatmap.track_attr=h,r(ze.para.heatmap.collect_tags)?!0===ze.para.heatmap.collect_tags.div?ze.para.heatmap.collect_tags.div={ignore_tags:p,max_level:1}:r(ze.para.heatmap.collect_tags.div)?(ze.para.heatmap.collect_tags.div.ignore_tags?v(ze.para.heatmap.collect_tags.div.ignore_tags)||(ze.log("ignore_tags 参数必须是数组格式"),ze.para.heatmap.collect_tags.div.ignore_tags=p):ze.para.heatmap.collect_tags.div.ignore_tags=p,ze.para.heatmap.collect_tags.div.max_level&&-1===X([1,2,3],ze.para.heatmap.collect_tags.div.max_level)&&(ze.para.heatmap.collect_tags.div.max_level=1)):ze.para.heatmap.collect_tags.div=!1:ze.para.heatmap.collect_tags={div:!1}}if(v(ze.para.server_url)&&ze.para.server_url.length)for(i=0;i<ze.para.server_url.length;i++)/sa\.gif[^\/]*$/.test(ze.para.server_url[i])||(ze.para.server_url[i]=ze.para.server_url[i].replace(/\/sa$/,"/sa.gif").replace(/(\/sa)(\?[^\/]+)$/,"/sa.gif$2"));else/sa\.gif[^\/]*$/.test(ze.para.server_url)||"string"!=typeof ze.para.server_url||(ze.para.server_url=ze.para.server_url.replace(/\/sa$/,"/sa.gif").replace(/(\/sa)(\?[^\/]+)$/,"/sa.gif$2"));"string"==typeof ze.para.server_url&&(ze.para.debug_mode_url=ze.para.debug_mode_url||ze.para.server_url.replace("sa.gif","debug")),!0===ze.para.noCache?ze.para.noCache="?"+(new Date).getTime():ze.para.noCache="",ze.para.callback_timeout>ze.para.datasend_timeout&&(ze.para.datasend_timeout=ze.para.callback_timeout),ze.para.heatmap&&ze.para.heatmap.collect_tags&&r(ze.para.heatmap.collect_tags)&&T(ze.para.heatmap.collect_tags,(function(e,t){"div"!==t&&e&&ze.heatmap.otherTags.push(t)})),ze.para.heatmap&&"default"===ze.para.heatmap.clickmap&&ze.heatmap.initUnlimitedTags()},setInitVar:function(){ze._t=ze._t||1*new Date,ze.lib_version=gt,ze.is_first_visitor=!1,ze.source_channel_standard=_t},enableLocalLog:function(){if(at.isSupport())try{sessionStorage.setItem("sensorsdata_jssdk_debug","true")}catch(e){ze.log("enableLocalLog error: "+e.message)}},disableLocalLog:function(){at.isSupport()&&sessionStorage.removeItem("sensorsdata_jssdk_debug")},quick:function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1);return"string"==typeof t&&Dt[t]?Dt[t].apply(Dt,r):void("function"==typeof t?t.apply(ze,r):ze.log("quick方法中没有这个功能"+e[0]))},use:function(t,n){return p(t)?r(window.SensorsDataWebJSSDKPlugin)&&r(window.SensorsDataWebJSSDKPlugin[t])&&e(window.SensorsDataWebJSSDKPlugin[t].init)?(window.SensorsDataWebJSSDKPlugin[t].init(ze,n),window.SensorsDataWebJSSDKPlugin[t]):r(ze.modules)&&r(ze.modules[t])&&e(ze.modules[t].init)?(ze.modules[t].init(ze,n),ze.modules[t]):void ze.log(t+"没有获取到,请查阅文档，调整"+t+"的引入顺序！"):(ze.log("use插件名称必须是字符串！"),!1)},track:function(e,t,r){Bt.check({event:e,properties:t})&&Bt.send({type:"track",event:e,properties:t},r)},bind:function(e,t){return!!Bt.check({bindKey:e,bindValue:t})&&(ze.store._state.identities[e]=t,ze.store.save(),void Bt.send({type:"track_id_bind",event:"$BindID",properties:{}}))},unbind:function(e,t){if(!Bt.check({unbindKey:e,bindValue:t}))return!1;if(r(ze.store._state.identities)&&ze.store._state.identities.hasOwnProperty(e)&&ze.store._state.identities[e]===t){var n=ze.store.getUnionId().login_id;n&&e+"+"+t===n&&(ze.store._state.distinct_id=ze.store._state.first_id,ze.store._state.first_id="",ze.store.set("history_login_id",{name:"",value:""})),"$identity_cookie_id"!==e&&(delete ze.store._state.identities[e],ze.store.save())}var i={};i[e]=t,Bt.send({identities:i,type:"track_id_unbind",event:"$UnbindID",properties:{}})},trackLink:function(e,t,r){function n(e,t,r){function n(e){function n(){a||(a=!0,location.href=i.href)}e.stopPropagation(),e.preventDefault();var a=!1;setTimeout(n,1e3),ze.track(t,r,n)}var i=null;return(e=e||{}).ele&&(i=e.ele),e.event&&(i=e.target?e.target:e.event.target),r=r||{},!(!i||"object"!=Object(k.a)(i))&&(!i.href||/^javascript/.test(i.href)||i.target||i.download||i.onclick?(ze.track(t,r),!1):(e.event&&n(e.event),void(e.ele&&Pe(e.ele,"click",(function(e){n(e)})))))}"object"==Object(k.a)(e)&&e.tagName?n({ele:e},t,r):"object"==Object(k.a)(e)&&e.target&&e.event&&n(e,t,r)},trackLinks:function(e,t,r){return r=r||{},!(!e||"object"!=Object(k.a)(e))&&!(!e.href||/^javascript/.test(e.href)||e.target)&&void Pe(e,"click",(function(n){function i(){a||(a=!0,location.href=e.href)}n.preventDefault();var a=!1;setTimeout(i,1e3),ze.track(t,r,i)}))},setItem:function(e,t,r){Bt.check({item_type:e,item_id:t,properties:r})&&Bt.sendItem({type:"item_set",item_type:e,item_id:t,properties:r||{}})},deleteItem:function(e,t){Bt.check({item_type:e,item_id:t})&&Bt.sendItem({type:"item_delete",item_type:e,item_id:t})},setProfile:function(e,t){Bt.check({propertiesMust:e})&&Bt.send({type:"profile_set",properties:e},t)},setOnceProfile:function(e,t){Bt.check({propertiesMust:e})&&Bt.send({type:"profile_set_once",properties:e},t)},appendProfile:function(e,t){Bt.check({propertiesMust:e})&&(T(e,(function(t,r){p(t)?e[r]=[t]:v(t)?e[r]=t:(delete e[r],ze.log("appendProfile属性的值必须是字符串或者数组"))})),ee(e)||Bt.send({type:"profile_append",properties:e},t))},incrementProfile:function(e,t){var r=e;p(e)&&((e={})[r]=1),Bt.check({propertiesMust:e})&&(function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&!/-*\d+/.test(String(e[t])))return!1;return!0}(e)?Bt.send({type:"profile_increment",properties:e},t):ze.log("profile_increment的值只能是数字"))},deleteProfile:function(e){Bt.send({type:"profile_delete"},e),Tt.set("distinct_id",Xe()),Tt.set("first_id","")},unsetProfile:function(e,t){var r=e,n={};p(e)&&(e=[]).push(r),v(e)?(T(e,(function(e){p(e)?n[e]=!0:ze.log("profile_unset给的数组里面的值必须时string,已经过滤掉",e)})),Bt.send({type:"profile_unset",properties:n},t)):ze.log("profile_unset的参数是数组")},identify:function(e,t){function r(e){ze.store._state.identities.$identity_anonymous_id=e,ze.store.save()}"number"==typeof e&&(e=String(e));var n=Tt.getFirstId();if(void 0===e){var i=Xe();n?Tt.set("first_id",i):Tt.set("distinct_id",i),r(i)}else Bt.check({distinct_id:e})&&(!0===t?n?Tt.set("first_id",e):Tt.set("distinct_id",e):n?Tt.change("first_id",e):Tt.change("distinct_id",e),r(e))},trackSignup:function(e,t,r,n){"number"==typeof e&&(e=String(e)),Bt.check({distinct_id:e,event:t,properties:r})&&Ee(e,t,r,n)},registerPage:function(e){Bt.check({properties:e})?A(bt.currentProps,e):ze.log("register输入的参数有误")},clearAllRegister:function(e){Tt.clearAllProps(e)},clearPageRegister:function(e){var t;if(v(e)&&e.length>0)for(t=0;t<e.length;t++)p(e[t])&&e[t]in bt.currentProps&&delete bt.currentProps[e[t]];else if(!0===e)for(t in bt.currentProps)delete bt.currentProps[t]},register:function(e){Bt.check({properties:e})?Tt.setProps(e):ze.log("register输入的参数有误")},registerOnce:function(e){Bt.check({properties:e})?Tt.setPropsOnce(e):ze.log("registerOnce输入的参数有误")},registerSession:function(e){Bt.check({properties:e})?Tt.setSessionProps(e):ze.log("registerSession输入的参数有误")},registerSessionOnce:function(e){Bt.check({properties:e})?Tt.setSessionPropsOnce(e):ze.log("registerSessionOnce输入的参数有误")},login:Ie,loginWithKey:function(e,t){return"number"==typeof t&&(t=String(t)),"number"==typeof e&&(e=String(e)),!!Bt.check({loginIdKey:e})&&(vt.LOGIN===e?(Ie(t),!1):void Le({id:t,callback:null,name:e}))},logout:function(e){var t=Tt.getFirstId();if(t)if(Tt.set("first_id",""),!0===e){var r=Xe();Tt.set("distinct_id",r)}else Tt.set("distinct_id",t);Ce({$identity_cookie_id:ze.store._state.identities.$identity_cookie_id}),ze.store.set("history_login_id",{name:"",value:""})},getPresetProperties:function(){var e={$is_first_day:De(),$is_first_time:kt.is_page_first_visited,$referrer:bt.pageProp.referrer||"",$referrer_host:bt.pageProp.referrer?U(bt.pageProp.referrer):"",$url:K(),$url_path:V(),$title:document.title||"",_distinct_id:Tt.getDistinctId(),identities:JSON.parse(JSON.stringify(Tt._state.identities))},t=A({},bt.properties(),ze.store.getProps(),function(){var e=bt.campaignParams(),t={};return T(e,(function(e,r,n){-1!==(" "+ze.source_channel_standard+" ").indexOf(" "+r+" ")?t["$"+r]=n[r]:t[r]=n[r]})),t}(),e);return ze.para.preset_properties.latest_referrer&&ze.para.preset_properties.latest_referrer_host&&(t.$latest_referrer_host=""===t.$latest_referrer?"":U(t.$latest_referrer)),t},iOSWebClickPolyfill:function(){var e="",t=" { cursor: pointer; -webkit-tap-highlight-color: rgba(0,0,0,0); }";ze.heatmap&&v(ze.heatmap.otherTags)&&T(ze.heatmap.otherTags,(function(r){e+=r+t})),te()&&R()&&R()<13&&(ze.para.heatmap&&ze.para.heatmap.collect_tags&&ze.para.heatmap.collect_tags.div&&le("div, [data-sensors-click]"+t),ze.para.heatmap&&ze.para.heatmap.track_attr&&le("["+ze.para.heatmap.track_attr.join("], [")+"]"+t),""!==e&&le(e))},readyState:{state:0,historyState:[],stateType:{1:"1-init未开始",2:"2-init开始",3:"3-store完成"},getState:function(){return this.historyState.join("\n")},setState:function(e){String(e)in this.stateType&&(this.state=e),this.historyState.push(this.stateType[e])}},para_default:{preset_properties:{search_keyword_baidu:!1,latest_utm:!0,latest_traffic_source_type:!0,latest_search_keyword:!0,latest_referrer:!0,latest_referrer_host:!1,latest_landing_page:!1,latest_wx_ad_click_id:void 0,url:!0,title:!0},encrypt_cookie:!1,enc_cookie:!1,img_use_crossorigin:!1,name:"sa",max_referrer_string_length:200,max_string_length:500,max_id_length:255,max_key_length:100,cross_subdomain:!0,show_log:!1,is_debug:!1,debug_mode:!1,debug_mode_upload:!1,source_channel:[],sdk_id:"",send_type:"image",vtrack_ignore:{},auto_init:!0,is_track_single_page:!1,is_single_page:!1,batch_send:!1,source_type:{},callback_timeout:200,datasend_timeout:8e3,is_track_device_id:!1,ignore_oom:!0,app_js_bridge:!1},log:pe,debug:ft,IDENTITY_KEY:vt,on:function(e,t){var r=[];"string"==typeof e&&e in Et.EVENT_LIST&&(r=Et.EVENT_LIST[e],Et[r[0]].on(r[1],t))}},It=function(){this._events=[],this.pendingEvents=[]};It.prototype={emit:function(e){var t=[].slice.call(arguments,1);T(this._events,(function(r){r.type===e&&r.callback.apply(r.context,t)})),this.pendingEvents.push({type:e,data:t}),this.pendingEvents.length>20&&this.pendingEvents.shift()},on:function(e,t,r,n){"function"==typeof t&&(this._events.push({type:e,callback:t,context:r||this}),n=!1!==n,this.pendingEvents.length>0&&n&&T(this.pendingEvents,(function(n){n.type===e&&t.apply(r,n.data)})))},tempAdd:function(e,t){if(t&&e)return this.emit(e,t)},isReady:function(){}};var Ut={__proto__:null,parseSuperProperties:fe,searchConfigData:_e,strip_empty_properties:ge,getCurrentDomain:me,getEleInfo:ve,isBaiduTraffic:ye,getReferrerEqid:be,getReferrerEqidType:Se,getBaiduKeyword:yt,isReferralTraffic:we,getReferrer:ke,getKeywordFromReferrer:Ae,getWxAdIdFromUrl:Oe,getReferSearchEngine:Te,getSourceFromReferrer:xe,info:bt,ajax:Be,getElementContent:je,cookie:St,addEvent:Pe,EventEmitterSa:It,encrypt:he,decryptIfNeeded:de},Rt={stage:null,init:function(e){this.stage=e}},Ft={buildData:function(e){var t={identities:{},distinct_id:ze.store.getDistinctId(),lib:{$lib:"js",$lib_method:"code",$lib_version:String(ze.lib_version)},properties:{}};return r(e)&&r(e.identities)&&!ee(e.identities)?A(t.identities,e.identities):A(t.identities,Tt._state.identities),r(e)&&r(e.properties)&&!ee(e.properties)&&(e.properties.$lib_detail&&(t.lib.$lib_detail=e.properties.$lib_detail,delete e.properties.$lib_detail),e.properties.$lib_method&&(t.lib.$lib_method=e.properties.$lib_method,delete e.properties.$lib_method)),A(t,ze.store.getUnionId(),e),function(e){jt.stage.process("addCustomProps",e)}(t),r(e.properties)&&!ee(e.properties)&&A(t.properties,e.properties),e.type&&"profile"===e.type.slice(0,7)||(t.properties=A({},bt.properties(),Tt.getProps(),Tt.getSessionProps(),bt.currentProps,t.properties),ze.para.preset_properties.latest_referrer&&!p(t.properties.$latest_referrer)&&(t.properties.$latest_referrer="取值异常"),ze.para.preset_properties.latest_search_keyword&&!p(t.properties.$latest_search_keyword)&&(ze.para.preset_properties.search_keyword_baidu&&p(t.properties.$search_keyword_id)&&ie(t.properties.$search_keyword_id_hash)&&p(t.properties.$search_keyword_id_type)||(t.properties.$latest_search_keyword="取值异常")),ze.para.preset_properties.latest_traffic_source_type&&!p(t.properties.$latest_traffic_source_type)&&(t.properties.$latest_traffic_source_type="取值异常"),ze.para.preset_properties.latest_landing_page&&!p(t.properties.$latest_landing_page)&&(t.properties.$latest_landing_page="取值异常"),"not_collect"===ze.para.preset_properties.latest_wx_ad_click_id?(delete t.properties._latest_wx_ad_click_id,delete t.properties._latest_wx_ad_hash_key,delete t.properties._latest_wx_ad_callbacks):ze.para.preset_properties.latest_wx_ad_click_id&&!p(t.properties._latest_wx_ad_click_id)&&(t.properties._latest_wx_ad_click_id="取值异常",t.properties._latest_wx_ad_hash_key="取值异常",t.properties._latest_wx_ad_callbacks="取值异常"),p(t.properties._latest_wx_ad_click_id)&&(t.properties.$url=K())),t.properties.$time&&$(t.properties.$time)?(t.time=1*t.properties.$time,delete t.properties.$time):t.time=1*new Date,ze.vtrackBase.addCustomProps(t),fe(t),kt.checkIsAddSign(t),kt.checkIsFirstTime(t),ze.addReferrerHost(t),ze.addPropsHook(t),function(e){jt.stage.process("formatData",e)}(t),t},sendData:function(e,t){var r=_e(e.properties);!0===ze.para.debug_mode?(ze.log(e),ze.saEvent.debugPath(JSON.stringify(e),t)):ze.sendState.getSendCall(e,r,t)},encodeTrackData:function(e){var t=B(e),r="crc="+Z(t);return"data="+encodeURIComponent(t)+"&ext="+encodeURIComponent(r)},getUtmData:function(){return Rt.stage&&Rt.stage.process("getUtmData")}},Ht=function(e){this.callback=e.callback,this.img=document.createElement("img"),this.img.width=1,this.img.height=1,ze.para.img_use_crossorigin&&(this.img.crossOrigin="anonymous"),this.data=e.data,this.server_url=function(e,t){var r=Ft.encodeTrackData(t);return-1!==e.indexOf("?")?e+"&"+r:e+"?"+r}(e.server_url,e.data)};Ht.prototype.start=function(){var e=this;ze.para.ignore_oom&&(this.img.onload=function(){this.onload=null,this.onerror=null,this.onabort=null,e.isEnd()},this.img.onerror=function(){this.onload=null,this.onerror=null,this.onabort=null,e.isEnd()},this.img.onabort=function(){this.onload=null,this.onerror=null,this.onabort=null,e.isEnd()}),this.img.src=this.server_url},Ht.prototype.lastClear=function(){void 0!==J().ie?this.img.src="about:blank":this.img.src=""};var Mt=function(e){this.callback=e.callback,this.server_url=e.server_url,this.data=Ue(e.data)};Mt.prototype.start=function(){var e=this;Be({url:this.server_url,type:"POST",data:this.data,credentials:!1,timeout:ze.para.datasend_timeout,cors:!0,success:function(){e.isEnd()},error:function(){e.isEnd()}})};var Jt=function(e){this.callback=e.callback,this.server_url=e.server_url,this.data=Ue(e.data)};Jt.prototype.start=function(){var e=this;"object"==("undefined"==typeof navigator?"undefined":Object(k.a)(navigator))&&"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(this.server_url,this.data),setTimeout((function(){e.isEnd()}),40)};var qt={stage:null,init:function(e){this.stage=e},interceptor:{send:{entry:function(e,t){var r=t.sensors,n=e.callback;return r.para.app_js_bridge?r.para.app_js_bridge.is_mui?r.para.app_js_bridge.is_mui?window.plus&&window.plus.SDAnalytics&&window.plus.SDAnalytics.trackH5Event?(window.plus.SDAnalytics.trackH5Event(e),r._.isFunction(n)&&n(),e):!0===r.para.app_js_bridge.is_send?(r.sendState.prepareServerUrl(e),e):(r._.isFunction(n)&&n(),e):void 0:!0===r.para.app_js_bridge.is_send?(r.debug.apph5({data:e.data,step:"2",output:"all"}),r.sendState.prepareServerUrl(e),e):(r._.isFunction(n)&&n(),e):(r.debug.apph5({data:e.data,step:"1",output:"code"}),r.sendState.prepareServerUrl(e),e)}}}},Kt={getSendCall:function(e,t,r){if(ze.is_heatmap_render_mode)return!1;if(ze.readyState.state<3)return ze.log("初始化没有完成"),!1;e._track_id=Number(String(n()).slice(2,5)+String(n()).slice(2,4)+String((new Date).getTime()).slice(-4)),e._flush_time=(new Date).getTime();var i=e;e=JSON.stringify(e);var a={data:i,config:t,callback:r};return ze.events.tempAdd("send",i),!ze.para.app_js_bridge&&ze.para.batch_send&&hr.isSupport()&&localStorage.length<100?(ze.log(i),ze.batchSend.add(a.data),!1):("item_set"===i.type||"item_delete"===i.type?this.prepareServerUrl(a):qt.stage.process("beforeSend",a),void ze.log(i))},prepareServerUrl:function(e){if("object"==Object(k.a)(e.config)&&e.config.server_url)this.sendCall(e,e.config.server_url,e.callback);else if(v(ze.para.server_url)&&ze.para.server_url.length)for(var t=0;t<ze.para.server_url.length;t++)this.sendCall(e,ze.para.server_url[t]);else"string"==typeof ze.para.server_url&&""!==ze.para.server_url?this.sendCall(e,ze.para.server_url,e.callback):ze.log("当前 server_url 为空或不正确，只在控制台打印日志，network 中不会发数据，请配置正确的 server_url！")},sendCall:function(e,t,n){var i={server_url:t,data:JSON.stringify(e.data),callback:n,config:e.config};r(ze.para.jsapp)&&!ze.para.jsapp.isOnline&&"function"==typeof ze.para.jsapp.setData?(delete i.callback,i=JSON.stringify(i),ze.para.jsapp.setData(i)):this.realtimeSend(i)},realtimeSend:function(e){(function(e){var t=Re(e),r=t.start;return t.start=function(){var e=this;r.apply(this,arguments),setTimeout((function(){e.isEnd(!0)}),ze.para.callback_timeout)},t.end=function(){this.callback&&this.callback();var e=this;setTimeout((function(){e.lastClear&&e.lastClear()}),ze.para.datasend_timeout-ze.para.callback_timeout)},t.isEnd=function(){this.received||(this.received=!0,this.end())},t})(e).start()}},Vt=["setItem","deleteItem","getAppStatus","track","quick","register","registerPage","registerOnce","trackSignup","setProfile","setOnceProfile","appendProfile","incrementProfile","deleteProfile","unsetProfile","identify","login","logout","trackLink","clearAllRegister","clearPageRegister","bind","unbind","loginWithKey"];Je.prototype.process=function(e,t){if(e&&e in this.processDef){var r=this.registeredInterceptors[e];if(r&&v(r)&&r.length>0)for(var n={current:0,total:r.length},i=new Me(t,n,ze),a=0;a<r.length;a++)try{if(n.current=a+1,t=r[a].call(null,t,i)||t,i.cancellationToken.getCanceled())break}catch(e){pe("interceptor error:"+e)}return this.processDef[e]&&this.processDef[e]in this.processDef&&(t=this.process(this.processDef[e],t)),t}pe("process ["+e+"] is not supported")},Je.prototype.registerStageImplementation=function(t){t&&t.init&&e(t.init)&&(t.init(this),t.interceptor&&this.registerInterceptor(t.interceptor))},Je.prototype.registerInterceptor=function(t){if(t)for(var n in t){var i=t[n];if(i&&r(i)&&e(i.entry)){ie(i.priority)||(i.priority=Number.MAX_VALUE),this.registeredInterceptors[n]||(this.registeredInterceptors[n]=[]);var a=this.registeredInterceptors[n];i.entry.priority=i.priority,a.push(i.entry),a.sort((function(e,t){return e.priority-t.priority}))}}};var zt=new Je({addCustomProps:null,formatData:null}),Wt=new Je({beforeSend:"send",send:"afterSend",afterSend:null}),Zt=new Je({getUtmData:null}),Qt={init:function(){},interceptor:{formatData:{priority:0,entry:function(e){return Ve(e),e}}}},Xt={add:function(e){ze.para.batch_send=!1;var t=_e(e.properties);ze.sendState.prepareServerUrl({data:e,config:t})}};for(var Yt in Lt)ze[Yt]=Lt[Yt];return ze.modules={},Ze.setup(pe),ze._=A(lt,Ut),ze.sendState=Kt,ze.events=new ze._.EventEmitterSa,ze.store=Tt,ze.heatmap=Nt,ze.bridge={initPara:function(){},initState:function(){},initDefineBridgeInfo:function(){},bridge_info:{touch_app_bridge:!1},dataSend:function(e,t){t.prepareServerUrl(e)}},ze.JSBridge=function(){},ze.vtrackBase={init:function(){},addCustomProps:function(){}},ze.batchSend=Xt,ze.use=function(t,n){if(!p(t))return pe("use插件名称必须是字符串！"),!1;if(r(window.SensorsDataWebJSSDKPlugin)&&r(window.SensorsDataWebJSSDKPlugin[t])&&e(window.SensorsDataWebJSSDKPlugin[t].__constructor__)){var i=new window.SensorsDataWebJSSDKPlugin[t].__constructor__;return i.init(ze,n),i}pe(t+"多版本 SDK，不支持"+t+"插件！")},qe(new function(e){e.kit=Ft,e.saEvent=Bt,this.dataStage=jt,this.sendStage=qt,this.businessStage=Rt}(ze)),qe(new function(){this.dataStage=Qt}(ze)),ze.init=function(e){return!(ze.readyState&&ze.readyState.state&&ze.readyState.state>=2)&&((e=e||{}).batch_send=!1,r(e.heatmap)&&(e.heatmap.get_vtrack_config=!1),ze.setInitVar(),ze.readyState.setState(2),ze.initPara(e),Fe(),void ze.iOSWebClickPolyfill())},T(Vt,(function(e){var t=ze[e];ze[e]=function(){if(ze.readyState.state<3)return v(ze._q)||(ze._q=[]),ze._q.push([e,arguments]),!1;if(ze.readyState.getState())return t.apply(ze,arguments);try{console.error("请先初始化神策JS SDK")}catch(e){ze.log(e)}}})),ze}(),window["_by_sensors_instance_".concat(e)]},A={},O=Array.prototype,x=Object.prototype,j=O.slice,B=x.toString,P=x.hasOwnProperty,N=O.forEach,D=Array.isArray,$={};function C(e){this.SensorsABTest=e,this.para=e.para}function E(e){this.SensorsABTest=e,this.para=e.para}A.each=function(e,t,s){if(null==e)return!1;if(N&&e.forEach===N)e.forEach(t,s);else if(A.isArray(e)&&e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(r in e&&t.call(s,e[r],r,e)===$)return!1}else for(var n in e)if(P.call(e,n)&&t.call(s,e[n],n,e)===$)return!1},A.extend=function(e){return A.each(j.call(arguments,1),(function(t){for(var s in t)P.call(t,s)&&void 0!==t[s]&&(e[s]=t[s])})),e},A.isArray=D||function(e){return"[object Array]"===B.call(e)},A.isObject=function(e){return null!=e&&"[object Object]"==B.call(e)},A.isElement=function(e){return!(!e||1!==e.nodeType)},A.isString=function(e){return"[object String]"==B.call(e)},A.isBoolean=function(e){return"[object Boolean]"==B.call(e)},A.isNumber=function(e){return"[object Number]"==B.call(e)&&/[\d\.]+/.test(String(e))},A.unique=function(e){for(var t,s=[],r={},i=0;i<e.length;i++)(t=e[i])in r||(r[t]=!0,s.push(t));return s},A.decodeURIComponent=function(e){var t=e;try{t=decodeURIComponent(e)}catch(r){t=e}return t},A.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=A.decodeURIComponent(e);var s=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===s||s&&"string"!=typeof s[1]&&s[1].length?"":A.decodeURIComponent(s[1])},A.indexOf=function(e,t){var s=e.indexOf;if(s)return s.call(e,t);for(var r=0;r<e.length;r++)if(t===e[r])return r;return-1},A.isFunction=function(e){if(!e)return!1;var t=Object.prototype.toString.call(e);return"[object Function]"==t||"[object AsyncFunction]"==t},A.isEmptyObject=function(e){if(A.isObject(e)){for(var t in e)if(P.call(e,t))return!1;return!0}return!1},A.map=function(e,t){var s=[];return null==e?s:Array.prototype.map&&e.map===Array.prototype.map?e.map(t):(A.each(e,(function(e,r,i){s.push(t(e,r,i))})),s)},A.base64Decode=function(e){var t=A.map(atob(e).split(""),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}));return decodeURIComponent(t.join(""))},A.getURLSearchParams=function(e){for(var t=function(e){return decodeURIComponent(e)},s={},r=(e=e||"").substring(1).split("&"),i=0;i<r.length;i++){var n=r[i].indexOf("=");if(-1!==n){var a=r[i].substring(0,n),o=r[i].substring(n+1);a=t(a),o=t(o),s[a]=o}}return s},A.urlParse=function(e){var t=function(e){this._fields={Username:4,Password:5,Port:7,Protocol:2,Host:6,Path:8,URL:0,QueryString:9,Fragment:10},this._values={},this._regex=null,this._regex=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?(\w*)/,void 0!==e&&this._parse(e)};return t.prototype.setUrl=function(e){this._parse(e)},t.prototype._initValues=function(){for(var e in this._fields)this._values[e]=""},t.prototype.addQueryString=function(e){if("object"!=Object(k.a)(e))return!1;var t=this._values.QueryString||"";for(var s in e)t=new RegExp(s+"[^&]+").test(t)?t.replace(new RegExp(s+"[^&]+"),s+"="+e[s]):"&"===t.slice(-1)?t+s+"="+e[s]:""===t?s+"="+e[s]:t+"&"+s+"="+e[s];this._values.QueryString=t},t.prototype.getUrl=function(){var e="";return e+=this._values.Origin,e+=this._values.Port?":"+this._values.Port:"",e+=this._values.Path,(e+=this._values.QueryString?"?"+this._values.QueryString:"")+(this._values.Fragment?"#"+this._values.Fragment:"")},t.prototype.getUrl=function(){var e="";return e+=this._values.Origin,e+=this._values.Port?":"+this._values.Port:"",(e+=this._values.Path)+(this._values.QueryString?"?"+this._values.QueryString:"")},t.prototype._parse=function(e){this._initValues();var t=this._regex.exec(e);for(var s in t||A.log("DPURLParser::_parse -> Invalid URL"),this._fields)void 0!==t[this._fields[s]]&&(this._values[s]=t[this._fields[s]]);this._values.Hostname=this._values.Host.replace(/:\d+$/,""),this._values.Origin=this._values.Protocol+"://"+this._values.Hostname},new t(e)},A.URL=function(e){var t,s={};if("function"==typeof window.URL&&function(){try{return"http://modernizr.com/"===new URL("http://modernizr.com/").href}catch(e){return!1}}())(s=new URL(e)).searchParams||(s.searchParams=(t=A.getURLSearchParams(s.search),{get:function(e){return t[e]}}));else{!1===/^https?:\/\/.+/.test(e)&&A.log("Invalid URL");var r=A.urlParse(e);s.hash="",s.host=r._values.Host?r._values.Host+(r._values.Port?":"+r._values.Port:""):"",s.href=r._values.URL,s.password=r._values.Password,s.pathname=r._values.Path,s.port=r._values.Port,s.search=r._values.QueryString?"?"+r._values.QueryString:"",s.username=r._values.Username,s.hostname=r._values.Hostname,s.protocol=r._values.Protocol?r._values.Protocol+":":"",s.origin=r._values.Origin?r._values.Origin+(r._values.Port?":"+r._values.Port:""):"",s.searchParams=function(){var e=A.getURLSearchParams("?"+r._values.QueryString);return{get:function(t){return e[t]}}}()}return s},A.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=A.decodeURIComponent(e);var s=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===s||s&&"string"!=typeof s[1]&&s[1].length?"":A.decodeURIComponent(s[1])},A.isEmptyObject=function(e){if(A.isObject(e)){for(var t in e)if(P.call(e,t))return!1;return!0}return!1},A.contentLoaded=function(e,t){var s=!1,r=!0,i=e.document,n=i.documentElement,a=i.addEventListener,o=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",l=a?"":"on",u=function u(r){"readystatechange"==r.type&&"complete"!=i.readyState||(("load"==r.type?e:i)[c](l+r.type,u,!1),!s&&(s=!0)&&t.call(e,r.type||r))};if("complete"==i.readyState)t.call(e,"lazy");else{if(!a&&n.doScroll){try{r=!e.frameElement}catch(e){}r&&function e(){try{n.doScroll("left")}catch(t){return void setTimeout(e,50)}u("poll")}()}i[o](l+"DOMContentLoaded",u,!1),i[o](l+"readystatechange",u,!1),e[o](l+"load",u,!1)}},A.secCheck={isHttpUrl:function(e){return"string"==typeof e&&(!1!==/^https?:\/\/.+/.test(e)||(A.log("Invalid URL"),!1))},removeScriptProtocol:function(e){if("string"!=typeof e)return"";for(var t=/^\s*javascript/i;t.test(e);)e=e.replace(t,"");return e}},A.addEvent=function(){function e(t){return t&&(t.preventDefault=e.preventDefault,t.stopPropagation=e.stopPropagation,t._getPath=e._getPath),t}e._getPath=function(){var e=this;return this.path||this.composedPath&&this.composedPath()||function(){try{var t=e.target,s=[t];if(null===t||null===t.parentElement)return[];for(;null!==t.parentElement;)t=t.parentElement,s.unshift(t);return s}catch(e){return[]}}()},e.preventDefault=function(){this.returnValue=!1},e.stopPropagation=function(){this.cancelBubble=!0},function(t,s,r){if(t&&t.addEventListener)t.addEventListener(s,(function(t){t._getPath=e._getPath,r.call(this,t)}),!0);else{var i="on"+s,n=t[i];t[i]=function(t,s,r){return function(i){if(i=i||e(window.event)){i.target=i.srcElement;var n,a,o=!0;return"function"==typeof r&&(n=r(i)),a=s.call(t,i),!1!==n&&!1!==a||(o=!1),o}}}(t,r,n)}}.apply(null,arguments)},A.addSinglePageEvent=function(e){var t=location.href,s=window.history.pushState,r=window.history.replaceState;window.history.pushState=function(){s.apply(window.history,arguments),e(t),t=location.href},window.history.replaceState=function(){r.apply(window.history,arguments),e(t),t=location.href};var i=s?"popstate":"hashchange";A.addEvent(window,i,(function(){e(t),t=location.href}))},A.trim=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},A.checkUrlIsMatch=function(e,t){var s,r,i=A.URL(e);if("STRICT"===t)return location.href===i.href;if("FUZZY"===t){try{s=A.URL(location.href)}catch(e){return A.log("url 解析失败",e),!1}try{r=A.URL(e)}catch(e){return A.log("control_url 解析失败",e),!1}return s.host===r.host&&s.pathname===r.pathname}return A.log("link_match_type字段异常",t),!1},A.checkUrlIsRegexp=function(e,t){var s;try{s=A.URL(location.href)}catch(e){return A.log("url 解析失败",e),!1}try{var r=(t?new RegExp(e,t):new RegExp(e)).exec(s.href),i=!0;return!!r&&(A.each(r,(function(e){e||(i=!1)})),i)}catch(e){return A.log("control_link字段异常",e),!1}},A.log=function(){if("object"==("undefined"==typeof console?"undefined":Object(k.a)(console))&&console.log){A.isString(arguments[0])&&(arguments[0]="sensorsabtest————"+arguments[0]);try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}}},A.error=function(){if("object"==("undefined"==typeof console?"undefined":Object(k.a)(console))&&console.error)try{return console.error.apply(console,arguments)}catch(e){console.error(arguments[0])}},A.storage={isSupport:function(){var e=!0;try{var t="__sensorsdatasupport__",s="testIsSupportStorage";window.localStorage.setItem(t,s),window.localStorage.getItem(t)!==s&&(e=!1),window.localStorage.removeItem(t)}catch(t){e=!1}return e},set:function(e,t){this.isSupport()&&window.localStorage.setItem(t,e)},get:function(e){var t=null;return this.isSupport()&&(t=window.localStorage.getItem(e)),t}},A.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())},A.isDate=function(e){return"[object Date]"==Object.prototype.toString.call(e)},C.prototype={init:function(e){if(!this.setPara(e))return!1;this.bridgeState="ab_no_host_bridge",/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?this.SensorsABTest.state.platform="H5":this.SensorsABTest.state.platform="Web",this.SensorsABTest.log("A/B Testing SDK 初始化成功，试验 URL：",e.url),this.SensorsABTest.checkSADebug(),this.SensorsABTest.store.init(this.getResultFromServer,this)},setPara:function(e){if(!A.isString(e.url)||"http"!==e.url.slice(0,4))return this.SensorsABTest.log("A/B Testing SDK 初始化失败，请使用正确的 URL！"),!1;if("https"===location.protocol.slice(0,5)&&"http:"===e.url.slice(0,5))return this.SensorsABTest.log("A/B Testing SDK 初始化失败，https 页面必须使用 https 的 URL"),!1;var t=A.getQueryParam(e.url,"project-key");if(!t)return this.SensorsABTest.log("A/B Testing SDK 初始化失败，请使用正确的 URL（必须包含 project-key）！"),!1;e.project_key=t;var s=this.SensorsABTest.verifyStore.para("A/B Testing SDK 初始化",e,{timeout_milliseconds:"not_essential"});return this.SensorsABTest.para=A.extend({},this.SensorsABTest.default_para,s.para),A.isBoolean(this.SensorsABTest.para.collect_bridge_status)||(this.SensorsABTest.para.collect_bridge_status=!0),A.isNumber(this.SensorsABTest.para.update_interval)||(this.SensorsABTest.para.update_interval=6e5),!0===this.SensorsABTest.sd.para.encrypt_cookie&&(this.SensorsABTest.para.encrypt_cookie=!0),this.SensorsABTest.sd.para.sdk_id&&(this.SensorsABTest.state.storage.name+="_"+this.SensorsABTest.sd.para.sdk_id),!0},asyncFetch:function(e){var t=this;this.SensorsABTest.normalStore.getResultFromServer({para:e,suc:function(s){if(A.isObject(s)&&"SUCCESS"===s.status){var r=t.SensorsABTest.getExpResult(e);e.callback(r)}else e.callback(e.default_value)},err:function(){e.callback(e.default_value)}})},creatRequestData:function(e){var t="";A.isEmptyObject(this.SensorsABTest.sd.store._state)||(t=this.SensorsABTest.sd.store._state._first_id||this.SensorsABTest.sd.store._state.first_id||this.SensorsABTest.sd.store._state._distinct_id||this.SensorsABTest.sd.store._state.distinct_id);var s={anonymous_id:t,platform:this.SensorsABTest.state.platform,abtest_lib_version:this.SensorsABTest.lib_version,properties:{$is_first_day:this.SensorsABTest.sd._.cookie.getNewUser()}};return A.isObject(e.properties)&&(s.properties=A.extend({},s.properties,e.properties)),A.isObject(e.custom_properties)&&(s.custom_properties=A.extend({},e.custom_properties),s.param_name=e.param_name),this.SensorsABTest.sd.store._state.first_id&&(s.login_id=this.SensorsABTest.sd.store.getDistinctId()),s},getResultFromServer:function(e){var t,s=this,r=(e=A.isObject(e)?e:{}).para||{},i=e.suc,n=e.err,a=this.creatRequestData(r);this.SensorsABTest.log("向服务端发起试验请求"),t=s.SensorsABTest.sd.store.getDistinctId(),s.SensorsABTest.sd._.ajax({url:s.SensorsABTest.para.url,type:"POST",data:JSON.stringify(a),credentials:!1,contentType:"application/json",timeout:r.timeout_milliseconds||s.SensorsABTest.para.timeout_milliseconds,cors:!0,success:function(e){s.SensorsABTest.dealResponseData(e,t),i&&i(e),s.SensorsABTest.fetchData.setNextFetch()},error:function(e){s.SensorsABTest.log("服务端请求发送失败",e),n&&n(),s.SensorsABTest.fetchData.setNextFetch()}})}},C.prototype.methods={asyncFetchABTest:function(e){if(!A.isObject(e))return this.SensorsABTest.log("asyncFetchABTest调用失败，参数未正确配置"),!1;var t=this.SensorsABTest.verifyStore.para("asyncFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(t.verify_success){e=t.para;var s=this.SensorsABTest.verifyStore.resolveCustomProperties(e);s.verify_success?(e=s.para,this.SensorsABTest.normalStore.asyncFetch(e)):e.callback(e.default_value)}},fastFetchABTest:function(e){if(!A.isObject(e))return this.SensorsABTest.log("fastFetchABTest调用失败，参数未正确配置"),!1;var t=this.SensorsABTest.verifyStore.para("fastFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(t.verify_success){e=t.para;var s=this.SensorsABTest.searchLocalExp(e.param_name);if(A.isObject(s)){var r=this.SensorsABTest.getExpResult(e,s);e.callback(r)}else{var i=this.SensorsABTest.verifyStore.resolveCustomProperties(e);i.verify_success?(e=i.para,this.SensorsABTest.log("fastFetchABTest缓存中未读取到数据，发起请求"),this.SensorsABTest.normalStore.asyncFetch(e)):e.callback(e.default_value)}}},fetchCacheABTest:function(e){if(A.isObject(e)){var t=this.SensorsABTest.verifyStore.para("fetchCacheABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential"});if(t.verify_success)return this.SensorsABTest.getExpResult(t.para)}else this.SensorsABTest.log("fetchCacheABTest调用失败，参数未正确配置")}},E.prototype={init:function(e){var t=this;if(this.SensorsABTest.state.storage.name="sawebjssdkabtest_bridge",!this.setPara(e))return!1;this.SensorsABTest.log("A/B Testing SDK 初始化成功"),this.abBridge=new this.SensorsABTest.sd.JSBridge({type:"abtest",app_call_js:function(e){try{e=A.base64Decode(e)}catch(r){t.SensorsABTest.log("App数据base64解码异常",e)}try{(e=JSON.parse(e)).message_id&&this.double(e)}catch(r){t.SensorsABTest.log("App数据解析异常",e)}}}),A.isObject(window.SensorsData_iOS_JS_Bridge)&&window.SensorsData_iOS_JS_Bridge.sensorsdata_abtest_module&&this.abBridge.hasAppBridge()||A.isObject(window.SensorsData_APP_New_H5_Bridge)&&A.isFunction(window.SensorsData_APP_New_H5_Bridge.sensorsdata_abtest_module)&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_abtest_module()&&this.abBridge.hasAppBridge()?this.SensorsABTest.bridgeState="ab_bridge_ok":this.SensorsABTest.bridgeState="ab_no_abtest_bridge",this.SensorsABTest.store.init(this.getResultFromApp,this)},setPara:function(e){var t=this.SensorsABTest.verifyStore.para("打通初始化",e,{timeout_milliseconds:"not_essential"});return this.SensorsABTest.para=A.extend({},this.SensorsABTest.default_para,t.para),A.isBoolean(this.SensorsABTest.para.collect_bridge_status)||(this.SensorsABTest.para.collect_bridge_status=!0),A.isNumber(this.SensorsABTest.para.update_interval)||(this.SensorsABTest.para.update_interval=6e5),!0===this.SensorsABTest.sd.para.encrypt_cookie&&(this.SensorsABTest.para.encrypt_cookie=!0),this.SensorsABTest.sd.para.sdk_id&&(this.SensorsABTest.state.storage.name+="_"+this.SensorsABTest.sd.para.sdk_id),!0},getResultFromApp:function(e){var t=this,s=(e=A.isObject(e)?e:{}).para||{},r=e.suc,i=e.err,n=s.timeout_milliseconds||this.SensorsABTest.para.timeout_milliseconds,a={origin_platform:"H5"};A.isObject(s.custom_properties)&&(a=A.extend(a,{custom_properties:s.custom_properties,param_name:s.param_name})),this.SensorsABTest.log("向App发起试验请求"),"ab_bridge_ok"===t.SensorsABTest.bridgeState?t.abBridge.requestToApp({data:{properties:s.properties,timeout:n,request_body:a},callback:function(e){A.isObject(e)&&A.isObject(e.data)?(t.SensorsABTest.log("成功获取到 App 端返回的试验数据","data:",e),t.SensorsABTest.dealResponseData(e.data),r&&r(e)):(t.SensorsABTest.log("App 端请求失败"),i&&i()),t.SensorsABTest.fetchData.setNextFetch()},timeout:{time:n,callback:function(){t.SensorsABTest.log("获取App端数据失败"),i&&i(),t.SensorsABTest.fetchData.setNextFetch()}}}):i&&(t.SensorsABTest.log("A/B Testing 打通失败，",t.SensorsABTest.bridgeState),i())},asyncFetch:function(e){var t=this;this.SensorsABTest.bridgeStore.getResultFromApp({para:e,suc:function(s){if(A.isObject(s.properties)&&(e.properties=A.extend(s.properties,e.properties)),"SUCCESS"===s.data.status){var r=t.SensorsABTest.getExpResult(e);e.callback(r)}else e.callback(e.default_value)},err:function(){e.callback(e.default_value)}})}},E.prototype.methods={asyncFetchABTest:function(e){if(!A.isObject(e))return this.SensorsABTest.log("asyncFetchABTest调用失败，参数未正确配置"),!1;var t=this.SensorsABTest.verifyStore.para("asyncFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(t.verify_success){e=t.para;var s=this.SensorsABTest.verifyStore.resolveCustomProperties(e);s.verify_success?(e=s.para,"ab_bridge_ok"===this.SensorsABTest.bridgeState?this.SensorsABTest.bridgeStore.asyncFetch(e):e.callback(e.default_value)):e.callback(e.default_value)}},fastFetchABTest:function(e){if(!A.isObject(e))return this.SensorsABTest.log("fastFetchABTest调用失败，参数未正确配置"),!1;var t=this.SensorsABTest.verifyStore.para("fastFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(t.verify_success){e=t.para;var s=this.SensorsABTest.searchLocalExp(e.param_name);if(A.isObject(s)){var r=this.SensorsABTest.getExpResult(e,s);e.callback(r)}else{var i=this.SensorsABTest.verifyStore.resolveCustomProperties(e);i.verify_success?(e=i.para,"ab_bridge_ok"===this.SensorsABTest.bridgeState?(this.SensorsABTest.log("fastFetchABTest缓存中未读取到数据，发起请求"),this.SensorsABTest.bridgeStore.asyncFetch(e)):e.callback(e.default_value)):e.callback(e.default_value)}}},fetchCacheABTest:function(e){if(A.isObject(e)){var t=this.SensorsABTest.verifyStore.para("fetchCacheABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential"});if(t.verify_success)return this.SensorsABTest.getExpResult(t.para)}else this.SensorsABTest.log("fetchCacheABTest调用失败，参数未正确配置")}};function L(e){var t="t6KJCZa5pDdQ9khoEM3Tj70fbP2eLSyc4BrsYugARqFIw1mzlGNVXOHiWvxUn8",s=t.length-1,r={},i=0;for(i=0;i<t.length;i++)r[t.charAt(i)]=t.charAt(s-i);var n="";for(i=0;i<e.length;i++)e.charAt(i)in r?n+=r[e.charAt(i)]:n+=e.charAt(i);return n}function I(e){this.SensorsABTest=e}function U(e){var t=A.storage.get(e);A.isString(t)&&(t=function(e){return 0===e.indexOf("dfm-enc-")&&(e=L(e=e.substring("dfm-enc-".length))),e}(t));try{t=JSON.parse(t)}catch(e){A.log(e)}return t}function R(e,t,s){e=JSON.stringify(e),s&&(e=function(e){return"dfm-enc-"+L(e)}(e)),A.storage.set(e,t)}function F(e){this.attr_name="sa-abtest-"+e,this.remove_timer=null,this.is_added=!1,this.is_abort=!1,this.is_timeout=!1,this.style_element=null,this.createMaskStyle()}function H(e){this.SensorsABTest=e,this.isFirst=!0,this.start_time=null,this.mask_instance=null,this.is_filtered_out=!1,this.para={timeout:500,use_mask:!0,pass_params:!0,control_link_search:"default",experiment_link_search:"default"}}function M(e,t){e=e||window;var s=!1,r=!0,i=e.document,n=i.documentElement,a=i.addEventListener,o=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",l=a?"":"on",u=function u(r){"readystatechange"==r.type&&"complete"!=i.readyState||(("load"==r.type?e:i)[c](l+r.type,u,!1),!s&&(s=!0)&&t.call(e,r.type||r))};if("complete"==i.readyState)t.call(e,"lazy");else{if(!a&&n.doScroll){try{r=!e.frameElement}catch(e){}r&&function e(){try{n.doScroll("left")}catch(t){return void setTimeout(e,50)}u("poll")}()}i[o](l+"DOMContentLoaded",u,!1),i[o](l+"readystatechange",u,!1),e[o](l+"load",u,!1)}}function J(e,t){if(!e||!e.parentNode||!e.parentNode.children)return!1;t=t&&t.join?t:[];var s=e.nodeName.toLowerCase();return e&&"body"!==s&&1==e.nodeType?(t.unshift(function(e){var t=e.parentNode&&9==e.parentNode.nodeType?-1:function(e){if(!e.parentNode)return-1;for(var t=0,s=e.tagName,r=e.parentNode.children,i=0;i<r.length;i++)if(r[i].tagName===s){if(e===r[i])return t;t++}return-1}(e);return e.getAttribute&&e.getAttribute("id")&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(e.getAttribute("id"))?"#"+e.getAttribute("id"):e.tagName.toLowerCase()+(~t?":nth-of-type("+(t+1)+")":"")}(e)),e.getAttribute&&e.getAttribute("id")&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(e.getAttribute("id"))?t.join(" > "):J(e.parentNode,t)):(t.unshift("body"),t.join(" > "))}function K(e,t){return e.currentStyle?e.currentStyle[t]:e.ownerDocument.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function V(e){var t=e.childNodes,s="",r=!1;return A.each(t,(function(e){!1===r&&3===e.nodeType&&(A.isString(e.textContent)||A.isString(e.innerText)||A.isString(e.nodeValue))&&(s=A.trim(e.textContent||e.innerText||e.nodeValue||""),r=!0)})),s}function z(e,t){var s=function(){var e,t={},s=navigator.userAgent.toLowerCase();return(e=s.match(/opera.([\d.]+)/))?t.opera=Number(e[1].split(".")[0]):(e=s.match(/msie ([\d.]+)/))?t.ie=Number(e[1].split(".")[0]):(e=s.match(/edge.([\d.]+)/))?t.edge=Number(e[1].split(".")[0]):(e=s.match(/firefox\/([\d.]+)/))?t.firefox=Number(e[1].split(".")[0]):(e=s.match(/chrome\/([\d.]+)/))?t.chrome=Number(e[1].split(".")[0]):(e=s.match(/version\/([\d.]+).*safari/))?t.safari=Number(e[1].match(/^\d*.\d*/)):(e=s.match(/trident\/([\d.]+)/))&&(t.ie=11),t}(),r=s.ie&&s.ie<9,i="";if(A.each(t,(function(e,t){r&&e.indexOf("rgba")>-1&&(e=function(e){var t=e.match(/[\d.]+/g);return t.length>=3?"rgb("+t[0]+","+t[1]+","+t[2]+")":""}(e));var s=t.replace(/[A-Z]+/g,(function(e){return"-"+e.toLowerCase()}));i+=";"+s+": "+e})),""!==i){var n,o,c=e.style,l=c.cssText||"";!l||(";",(o=(n=l).length-";".length)>=0&&n.indexOf(";",o)==o)||(l+=";"),c.cssText=l+i}}function W(e,t,s){if(s||(s=function(e,t){var s=t.originProps,r={attributes:{}},i=s.attributes;return A.each(i.style||{},(function(t,s){r.attributes.style[s]=K(e,s)})),Object.hasOwnProperty.call(s,"text")&&(r.attributes.text=V(e)),A.each(["src","href"],(function(t){Object.hasOwnProperty.call(i,t)&&(r.attributes[t]=e[t])})),Object.hasOwnProperty.call(i,"target")&&(r.attributes.target=e.getAttribute("target")),r}(e,t)),function(e,t){var s=e.originProps,r=t.originProps,i=s.attributes,n=r.attributes,a=!0;return s.text&&s.text!==r.text&&(a=!1),i&&A.each(["src","href","target"],(function(e){i[e]&&i[e]!==n[e]&&(a=!1)})),a}(t,s)){var r=t.props;A.isObject(r)&&Z(e,r)}}function Z(e,t){if(Object.hasOwnProperty.call(t,"attributes")){var s=t.attributes;Object.hasOwnProperty.call(s,"style")&&z(e,s.style),A.each(["href","target","src"],(function(t){Object.hasOwnProperty.call(s,t)&&function(e,t,s){e.setAttribute(t,s)}(e,t,s[t])}))}Object.hasOwnProperty.call(t,"text")&&function(e,t){var s=e.childNodes,r=!1;A.each(s,(function(e){3===e.nodeType&&(r||(e.textContent?e.textContent=t:e.innerText?e.innerText=t:e.nodeValue=t,r=!0))}))}(e,t.text)}function Q(e,t){!function(e){e=A.extend({success:function(){},error:function(){},appendCall:function(e){document.getElementsByTagName("head")[0].appendChild(e)}},e);var t=null;"css"===e.type&&((t=document.createElement("link")).rel="stylesheet",t.href=e.url),"js"===e.type&&((t=document.createElement("script")).async="async",t.setAttribute("charset","UTF-8"),t.src=e.url,t.type="text/javascript"),e.id&&(t.id=e.id),t.onload=t.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e.success(),t.onload=t.onreadystatechange=null)},t.onerror=function(){e.error(),t.onerror=null},e.appendCall(t)}(A.extend({success:function(){},error:function(){},type:"js",url:e},t))}function X(e,t){var s=e.tagName.toLowerCase(),r=function(e,t){var s={};return A.each(t||[],(function(t){var r=t.replace(/[A-Z]+/g,(function(e){return"-"+e.toLowerCase()}));s[t]=K(e,r)})),s}(e,t),i={selector:J(e),originProps:{attributes:{style:r},text:V(e)},type:"text",tagName:s};return"a"===s&&(i.originProps.attributes.href=e.href,e.getAttribute("target")&&(i.originProps.attributes.target=e.getAttribute("target")),i.type="link"),"img"===s&&(i.originProps.attributes.src=e.src,i.type="img"),{originStyle:e.getAttribute("style"),eleInfo:i,ele:e}}function Y(e){var t=e.eleInfo,s=e.ele;if(s){var r=e.originStyle;Z(s,t.originProps),s.style.cssText=r||""}}function G(e){this.SensorsABTest=e,this.enable_visualize=!1,this.vabtest_url=location.protocol+"//static.sensorsdata.cn/sdk/plugin/vabtest/"+this.SensorsABTest.lib_version+"/vabtest.min.js",this.timeout=500,this.is_editor=!1,this.use_mask=!0,this.originData=[],this.visualExp=null,this.isFirst=!0,this.start_time=null,this.is_have_observer=!1,this.imgLoadingList=[],this.isTrigger=!1}function ee(){this.lib_version="0.1.2",this.para={},this.default_para={url:"",path:"",project_key:"",timeout_milliseconds:3e3,update_interval:6e5,collect_bridge_status:!0,session_limit:6e5,encrypt_cookie:!1},this.state={platform:"",storage:{name:"sawebjssdkabtest"}},this.bridgeState="",this.localdata={},this.originalData=[],this.triggerList={},this.updateTime=null,this.sd=null,this.link=new H(this),this.vabtest=new G(this),this.normalStore=new C(this),this.bridgeStore=new E(this),this.verifyStore=new I(this)}function te(e){this.SensorsABTest=e}function re(e){this.SensorsABTest=e}I.prototype={value_type_list:["Number","String","Object","Boolean"],regName:/^((?!^distinct_id$|^original_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_tag.*|^user_group.*)[a-zA-Z_][a-zA-Z\d_]*)$/i,valueType:function(e,t){switch(t){case"Number":if(A.isNumber(e))return!0;break;case"String":if(A.isString(e))return!0;break;case"Object":if(A.isObject(e))return!0;break;case"Boolean":if(!0===e||!1===e)return!0;break;default:return!1}return!1},para:function(e,t,s){var r=this,i={verify_success:!0,para:null};return A.each(s,(function(s,n){if("essential"===s)switch(n){case"param_name":A.isString(t.param_name)&&t.param_name.length>0||(r.SensorsABTest.log(e+"方法调用失败，param_name参数未正确配置！param_name:",t.param_name),i.verify_success=!1);break;case"value_type":A.isString(t.value_type)&&-1!==A.indexOf(r.value_type_list,t.value_type)||(r.SensorsABTest.log(e+"方法调用失败，value_type配置错误",t.value_type),i.verify_success=!1);break;case"default_value":void 0===t.default_value?(r.SensorsABTest.log(e+"方法调用失败，default_value参数未配置"),i.verify_success=!1):r.valueType(t.default_value,t.value_type)||(r.SensorsABTest.log(e+"方法调用失败，default_value类型必须与value_type一致！",t.default_value,t.value_type),i.verify_success=!1);break;case"callback":A.isFunction(t.callback)||(r.SensorsABTest.log(e+"方法调用失败，callback参数未正确配置"),i.verify_success=!1);break;default:i.verify_success=!1}else if("not_essential"===s)switch(n){case"timeout_milliseconds":t.timeout_milliseconds=t.timeout_milliseconds||r.SensorsABTest.para.timeout_milliseconds||r.SensorsABTest.default_para.timeout_milliseconds,(!A.isNumber(t.timeout_milliseconds)||A.isNumber(t.timeout_milliseconds)&&t.timeout_milliseconds<=0)&&(r.SensorsABTest.log("timeout_milliseconds 参数错误",t.timeout_milliseconds),t.timeout_milliseconds=r.SensorsABTest.para.timeout_milliseconds),t.timeout_milliseconds<200&&(t.timeout_milliseconds=200);break;case"properties":t.properties=A.isObject(t.properties)?t.properties:{}}})),i.para=t,i},resolveCustomProperties:function(e){var t=this,s={verify_success:!0,para:null},r=e.custom_properties;if(!A.isObject(r)||A.isEmptyObject(r))return delete e.custom_properties,s.para=e,s;if(A.each(r,(function(e,r){if((!A.isString(r)||!t.regName.test(r)||r.length>100)&&(t.SensorsABTest.log(" property name [ "+r+" ] is not invalid "),s.verify_success=!1),(A.isString(e)||A.isNumber(e)||A.isBoolean(e)||A.isArray(e)||A.isDate(e))&&!(A.isString(e)&&e.length>500)||(t.SensorsABTest.log("property [ "+r+" ] of value [ "+JSON.stringify(e)+" ] is not invalid"),s.verify_success=!1),A.isArray(e)){var i=!0;A.each(e,(function(e){!1!==i&&(A.isString(e)||(i=!1))})),i||(t.SensorsABTest.log("property  value type can be array, but only allow string item. property [ "+r+" ] of value  "+JSON.stringify(e)+"  is not invalid"),s.verify_success=!1)}})),!0===s.verify_success){var i={};A.each(r,(function(e,t){A.isDate(e)?i[t]=A.formatDate(e):A.isString(e)?i[t]=e:i[t]=JSON.stringify(e)})),e.custom_properties=i}return s.para=e,s}},F.prototype={createMaskStyle:function(){var e="["+this.attr_name+"],["+this.attr_name+"] body{opacity:0 !important;-khtml-opacity:0 !important;-moz-opacity:0;filter:alpha(opacity=0);}",t=document.createElement("style");t.type="text/css";try{t.appendChild(document.createTextNode(e))}catch(r){t.styleSheet.cssText=e}try{this.style_element=t,document.getElementsByTagName("head")[0].appendChild(t)}catch(e){A.log("error when create calls")}},show:function(e){try{var t=this;if(this.is_abort)return!1;var s=null;if(s=document.getElementsByTagName("html")[0],!A.isElement(s))return;s.setAttribute(this.attr_name,"1"),this.is_added=!0,A.isNumber(e)&&(this.remove_timer=setTimeout((function(){t.is_timeout=!0,t.remove()}),e))}catch(e){A.log("error when show calls")}},remove:function(){try{if(this.is_abort||(this.is_abort=!0),this.is_added){this.is_added=!1;var e=null;if(e=document.getElementsByTagName("html")[0],!A.isElement(e))return;e.removeAttribute(this.attr_name),this.style_element&&(document.getElementsByTagName("head")[0].removeChild(this.style_element),this.style_element=null)}this.remove_timer&&(clearTimeout(this.remove_timer),this.remove_timer=null)}catch(e){A.log("error when remove calls")}}},H.prototype.init=function(e){return this.initPara(e),this.para?A.getQueryParam(location.href,"saSDKMultilink")?(this.is_filtered_out=!0,!1):(this.start_time=(new Date).getTime(),this.para.use_mask&&this.initMask(),void this.addSinglePageListener()):(this.SensorsABTest.log("multilink is closed"),!1)},H.prototype.addSinglePageListener=function(){var e=this;A.addSinglePageEvent((function(t){return t!==location.href&&(e.is_filtered_out=!1,e.isFirst=!0,e.mask_instance&&e.mask_instance.remove(),A.getQueryParam(location.href,"saSDKMultilink")?(e.is_filtered_out=!0,!1):(e.start_time=(new Date).getTime(),e.para.use_mask&&e.initMask(),void e.resolve(e.SensorsABTest.originalData)))}))},H.prototype.initMask=function(){this.mask_instance=new F("link_"+this.SensorsABTest.sd.para.sdk_id),this.mask_instance.show(this.para.timeout)},H.prototype.initPara=function(e){if(A.isFunction(e))try{e=e()}catch(e){return this.SensorsABTest.log("link para error!"),void(this.para=!1)}!1===e?this.para=!1:A.isObject(e)&&(this.para.timeout=A.isNumber(e.timeout)&&e.timeout>=0?e.timeout:500,this.para.use_mask=A.isBoolean(e.use_mask)?e.use_mask:this.para.use_mask,this.para.control_link_search=A.isString(e.control_link_search)?e.control_link_search:"default",this.para.experiment_link_search=A.isString(e.experiment_link_search)?e.experiment_link_search:"default",this.para.pass_params=!A.isBoolean(e.pass_params)||e.pass_params)},H.prototype.resolve=function(e){var t=this;if(!this.para)return!1;if(!A.isArray(e))return!1;if(this.is_filtered_out)return!1;if(!this.isFirst)return!1;if(this.isFirst=!1,0===this.para.timeout)return!1;if((new Date).getTime()-this.start_time>this.para.timeout)return this.SensorsABTest.log("The multilink was stopped because the request timeout"),!1;var s=!1;A.each(e,(function(e){return!!A.isObject(e)&&!s&&"LINK"===e.experiment_type&&void(t.isTriggerLinkExp(e)&&(s=!0,t.redirectUrl(e)))})),!s&&this.para.use_mask&&this.mask_instance&&this.mask_instance.remove()},H.prototype.stopTrigger=function(){this.isFirst=!1,this.SensorsABTest.log("The multilink was stopped because the request failed"),this.para.use_mask&&this.mask_instance&&this.mask_instance.remove()},H.prototype.isTriggerLinkExp=function(e){return A.isString(e.control_link)&&A.isString(e.link_match_type)?"REGEXP"===e.link_match_type?!!A.checkUrlIsRegexp(e.control_link,e.regexp_flags)||(this.SensorsABTest.log("多链接试验匹配失败",e.abtest_experiment_id),!1):!!A.checkUrlIsMatch(e.control_link,e.link_match_type)||(this.SensorsABTest.log("多链接试验匹配失败",e.abtest_experiment_id),!1):(this.SensorsABTest.log("多链接试验数据异常",e.abtest_experiment_id),!1)},H.prototype.redirectUrl=function(e){if(e.experiment_link&&A.isString(e.experiment_link))if(!0!==e.is_control_group||"STRICT"!==e.link_match_type&&"REGEXP"!==e.link_match_type){var t,s,r=location.href,i=e.experiment_link;if("REGEXP"===e.link_match_type&&/\$\d+/.test(i)){var n=e.regexp_flags?new RegExp(e.control_link,e.regexp_flags):new RegExp(e.control_link);i=r.replace(n,i)}this.para.pass_params?(s=this.getMergedUrl(e.is_control_group,i,r),t=a(s)):(s=this.getMergedUrl(e.is_control_group,i),t=a(s)),t&&(this.SensorsABTest.triggerHandle(e)?setTimeout((function(){location.href=t}),80):setTimeout((function(){location.href=t}),0),this.mask_instance&&this.mask_instance.remove_timer&&clearTimeout(this.mask_instance.remove_timer))}else this.SensorsABTest.triggerHandle(e);else this.SensorsABTest.log("页面跳转失败，experiment_link字段异常",e.abtest_experiment_id);function a(e){return A.secCheck.isHttpUrl(e)?A.secCheck.removeScriptProtocol(e):(this.SensorsABTest.log("非法URL"),!1)}},H.prototype.getMergedUrl=function(e,t,s){var r="",i="",n="",a={parse_url:null,search:""},o={parse_url:null,search:"",hash:""};function c(e){var t=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(e);if(t)return{host:t[1]||"",search:t[2]||"",hash:t[3]||""}}if(!s||(a.parse_url=c(s),a.parse_url)){if(o.parse_url=c(t),o.parse_url)return s&&("after_hash"===this.para.control_link_search?a.search=l(a.parse_url.hash).search:a.search=a.parse_url.search),e?"after_hash"===this.para.control_link_search?(o.search=l(o.parse_url.hash).search,o.hash=l(o.parse_url.hash).hash):o.search=o.parse_url.search:"after_hash"===this.para.experiment_link_search?(o.search=l(o.parse_url.hash).search,o.hash=l(o.parse_url.hash).hash):o.search=o.parse_url.search,i=s?this.getSearchStr(a.search,o.search):this.getSearchStr(o.search),e&&"after_hash"===this.para.control_link_search||!e&&"after_hash"===this.para.experiment_link_search?r=o.hash.length>0?o.parse_url.host+o.parse_url.search+o.hash+i:o.parse_url.search.length>0?o.parse_url.host+o.parse_url.search+"&"+i.substring(1):o.parse_url.host+i:(n="after_hash"===this.para.control_link_search?o.parse_url.hash:s?o.parse_url.hash||a.parse_url.hash:o.parse_url.hash,r=o.parse_url.host+i+n),r;this.SensorsABTest.log("url 解析失败",t)}else this.SensorsABTest.log("url 解析失败",s);function l(e){var t={hash:"",search:""};if(!A.isString(e))return t;var s=e.indexOf("?");return s>-1?(t.search=e.slice(s),t.hash=e.slice(0,s)):t.hash=e,t}},H.prototype.getSearchStr=function(e,t){function s(e){var t={};if(!e||!e.length||0!==e.indexOf("?"))return t;if(!(e=e.slice(1)).length)return t;for(var s=e.split("&"),r=0;r<s.length;r++)if(s[r].indexOf("=")<0)t[s[r]]=null;else{var i=s[r].split("=");t[i[0]]=i[1]}return t}var r=s(e),i=s(t),n=A.extend(r,i),a="";if(A.isEmptyObject(n))return"?saSDKMultilink=true";var o=!0;for(var c in n)o?(a+="?",o=!1):a+="&",null!==n[c]?a=a+c+"="+n[c]:a+=c;return a+"&saSDKMultilink=true"},window.MutationObserver||(window.MutationObserver=function(e){function t(e){this._watched=[],this._listener=e}function s(t){var s={type:null,target:null,addedNodes:[],removedNodes:[],previousSibling:null,nextSibling:null,attributeName:null,attributeNamespace:null,oldValue:null};for(var r in t)f(s,r)&&t[r]!==e&&(s[r]=t[r]);return s}function r(t,r){var i=o(t,r);return function(n){var l,u=n.length;r.charData&&3===t.nodeType&&t.nodeValue!==i.charData&&n.push(new s({type:"characterData",target:t,oldValue:i.charData})),r.attr&&i.attr&&a(n,t,i.attr,r.afilter),(r.kids||r.descendents)&&(l=function(t,r,i,n){var o;function l(e,r,i,o,c){for(var l,d,p,h=e.length-1,f=-~((h-c)/2);p=e.pop();)l=i[p.i],d=o[p.j],n.kids&&f&&Math.abs(p.i-p.j)>=h&&(t.push(s({type:"childList",target:r,addedNodes:[l],removedNodes:[l],nextSibling:l.nextSibling,previousSibling:l.previousSibling})),f--),n.attr&&d.attr&&a(t,l,d.attr,n.afilter),n.charData&&3===l.nodeType&&l.nodeValue!==d.charData&&t.push(s({type:"characterData",target:l,oldValue:d.charData})),n.descendents&&u(l,d)}function u(r,i){for(var p,f,g,_,m,v,y,S=r.childNodes,b=i.kids,w=S.length,k=b?b.length:0,T=0,A=0,O=0;A<w||O<k;)(v=S[A])===(y=(m=b[O])&&m.node)?(n.attr&&m.attr&&a(t,v,m.attr,n.afilter),n.charData&&m.charData!==e&&v.nodeValue!==m.charData&&t.push(s({type:"characterData",target:v,oldValue:m.charData})),f&&l(f,r,S,b,T),n.descendents&&(v.childNodes.length||m.kids&&m.kids.length)&&u(v,m),A++,O++):(o=!0,p||(p={},f=[]),v&&(p[g=d(v)]||(p[g]=!0,-1===(_=c(b,v,O))?n.kids&&(t.push(s({type:"childList",target:r,addedNodes:[v],nextSibling:v.nextSibling,previousSibling:v.previousSibling})),T++):f.push({i:A,j:_})),A++),y&&y!==S[A]&&(p[g=d(y)]||(p[g]=!0,-1===(_=h(S,y,A))?n.kids&&(t.push(s({type:"childList",target:i.node,removedNodes:[y],nextSibling:b[O+1],previousSibling:b[O-1]})),T--):f.push({i:_,j:O})),O++));f&&l(f,r,S,b,T)}return u(r,i),o}(n,t,i,r)),(l||n.length!==u)&&(i=o(t,r))}}t._period=30,t.prototype={observe:function(e,s){for(var i,n={attr:!!(s.attributes||s.attributeFilter||s.attributeOldValue),kids:!!s.childList,descendents:!!s.subtree,charData:!(!s.characterData&&!s.characterDataOldValue)},a=this._watched,o=0;o<a.length;o++)a[o].tar===e&&a.splice(o,1);s.attributeFilter&&(n.afilter=p(s.attributeFilter,(function(e,t){return e[t]=!0,e}),{})),a.push({tar:e,fn:r(e,n)}),this._timeout||(i=this,function e(){var r=i.takeRecords();r.length&&i._listener(r,i),i._timeout=setTimeout(e,t._period)}())},takeRecords:function(){for(var e=[],t=this._watched,s=0;s<t.length;s++)t[s].fn(e);return e},disconnect:function(){this._watched=[],clearTimeout(this._timeout),this._timeout=null}};var i=document.createElement("i");i.style.top=0;var n=(i="null"!=i.attributes.style.value)?function(e,t){return t.value}:function(e,t){return"style"!==t.name?t.value:e.style.cssText};function a(e,t,r,i){for(var a,o,c={},l=t.attributes,u=l.length;u--;)o=(a=l[u]).name,i&&!f(i,o)||(n(t,a)!==r[o]&&e.push(s({type:"attributes",target:t,attributeName:o,oldValue:r[o],attributeNamespace:a.namespaceURI})),c[o]=!0);for(o in r)c[o]||e.push(s({target:t,type:"attributes",attributeName:o,oldValue:r[o]}))}function o(e,t){var s=!0;return function e(r){var i={node:r};return!t.charData||3!==r.nodeType&&8!==r.nodeType?(t.attr&&s&&1===r.nodeType&&(i.attr=p(r.attributes,(function(s,e){return t.afilter&&!t.afilter[e.name]||(s[e.name]=n(r,e)),s}),{})),s&&(t.kids||t.charData||t.attr&&t.descendents)&&(i.kids=function(e,t){for(var s=[],r=0;r<e.length;r++)s[r]=t(e[r],r,e);return s}(r.childNodes,e)),s=t.descendents):i.charData=r.nodeValue,i}(e)}function c(e,t,s){return h(e,t,s,"node")}var l=1,u="mo_id";function d(e){try{return e.id||(e[u]=e[u]||l++)}catch(t){try{return e.nodeValue}catch(e){return l++}}}function p(e,t,s){for(var r=0;r<e.length;r++)s=t(s,e[r],r,e);return s}function h(e,t,s,r){for(;s<e.length;s++)if((r?e[s][r]:e[s])===t)return s;return-1}function f(t,s){return t[s]!==e}return t}(void 0)),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),s=this,r=function(){},i=function(){return s.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),G.prototype.init=function(e){var t=this;this.initPara(e),!1!==this.enable_visualize&&(window.self!==window.top&&function(){if(!window.name)return!1;try{var e=JSON.parse(decodeURIComponent(window.name||"")),t=e.is_vabtesting,s=e.source_url,r=e.link_match_type;return!(!0!==t||!A.checkUrlIsMatch(s,r))||(A.log("A/B Testing SDK 页面地址，与当前实验 URL 不匹配，请使用正确的 URL！"),!1)}catch(e){return!1}}()?(this.is_editor=!0,document.getElementById("sa-abtesting-vabtest-script")||Q(this.vabtest_url,{id:"sa-abtesting-vabtest-script",success:function(){setTimeout((function(){t.SensorsABTest.sd.use("VABTest",{SensorsABTest:t.SensorsABTest})}),0)}})):(this.start_time=(new Date).getTime(),this.use_mask&&this.initMask(),this.addSinglePageListener()))},G.prototype.initPara=function(e){if(A.isFunction(e))try{e=e()}catch(e){return this.SensorsABTest.log("ABTesting SDK  !"),void(this.para=!1)}if(A.isObject(e)){Object.prototype.hasOwnProperty.call(e,"enable_visualize")&&A.isBoolean(e.enable_visualize)?this.enable_visualize=e.enable_visualize:this.SensorsABTest.log("ABTesting SDK 初始化参数 enable_visualize 格式不正确。 类型应为 Boolean"),this.use_mask=A.isBoolean(e.use_mask)?e.use_mask:this.use_mask,this.timeout=A.isNumber(e.timeout)&&e.timeout>=0?e.timeout:this.timeout;var t=A.isString(e.vabtest_url)?e.vabtest_url:"";t&&("https:"===location.protocol?"https:"===t.slice(0,6)?this.vabtest_url=t:this.SensorsABTest.log("ABTesting SDK 初始化参数 vabtest_url 协议头应设置为 https"):"http:"===t.slice(0,5)||"https:"===t.slice(0,6)?this.vabtest_url=t:this.SensorsABTest.log("ABTesting SDK 初始化参数 vabtest_url 应设置为有效 URL"))}else this.para=!1},G.prototype.resolve=function(e){if(!1!==this.enable_visualize&&!0!==this.is_editor&&!1!==this.isFirst){if((new Date).getTime()-this.start_time>this.timeout)return this.SensorsABTest.log("请求实验结果超时，A/B 可视化实验失败！"),!1;var t=this;this.isFirst=!1;var s=!1;A.each(e,(function(e){if(!A.isObject(e)||"VISUAL"!==e.experiment_type)return!1;if(s)return!1;var r=e.experiment_value;if(!A.isArray(r))try{r=JSON.parse(e.experiment_value),e.experiment_value=r}catch(e){return!1}t.isTriggerVisualExp(e)&&(s=!0,t.prepareResource(e,t.render.bind(t)),t.visualExp=e)})),!s&&this.use_mask&&this.destroyMask(),M(window,(function(){!function(e){new(0,window.MutationObserver)(e).observe(document.body,{childList:!0,subtree:!0})}(t.observerCallback.bind(t))}))}},G.prototype.initMask=function(){this.mask_instance=new F("vabtest_"+this.SensorsABTest.sd.para.sdk_id),this.mask_instance.show(this.timeout)},G.prototype.destroyMask=function(){this.mask_instance&&this.mask_instance.remove()},G.prototype.prepareResource=function(e,t){var s=this,r=e.experiment_value;A.isArray(r)&&(A.each(r,(function(r){var i=r.tagName,n=r.props;if("img"===i&&n&&n.attributes&&A.isString(n.attributes.src)){var a=n.attributes.src;s.imgLoadingList.push(a);var o=document.createElement("img");o.width=1,o.height=1,o.onload=c,o.onerror=c,o.onabort=c,o.src=n.attributes.src}function c(){var r=s.imgLoadingList.indexOf(a);r>-1&&s.imgLoadingList.splice(r,1),0===s.imgLoadingList.length&&t(e)}})),0===this.imgLoadingList.length&&t(e))},G.prototype.render=function(e){var t=this;M(window,(function(){if(t.use_mask&&t.mask_instance&&!0===t.mask_instance.is_timeout)t.SensorsABTest.log("渲染实验结果超时，A/B 可视化实验失败！");else{t.isTrigger||(t.SensorsABTest.triggerHandle(e),t.isTrigger=!0);var s=e.experiment_value;A.isArray(s)&&A.each(s,(function(e){var s=function(e){if(!A.isString(e))return null;var t,s=e.split(">");return(t=function e(t){var r,i=s.shift();if(!i)return t;try{r=function(e,t){var s;if("body"===(e=A.trim(e)))return document.getElementsByTagName("body")[0];if(0===e.indexOf("#"))e=e.slice(1),s=document.getElementById(e);else if(e.indexOf(":nth-of-type")>-1){var r=e.split(":nth-of-type");if(!r[0]||!r[1])return null;var i=r[0],n=r[1].match(/\(([0-9]+)\)/);if(!n||!n[1])return null;var a=Number(n[1]);if(!(A.isElement(t)&&t.children&&t.children.length>0))return null;for(var o=t.children,c=0;c<o.length;c++)if(A.isElement(o[c])&&o[c].tagName.toLowerCase()===i&&0==--a){s=o[c];break}if(a>0)return null}return s||null}(i,t)}catch(e){r=null}return r&&A.isElement(r)?e(r):null}())&&A.isElement(t)?t:null}(e.selector);if(s)try{var r=X(s,[]);W(s,e,r.eleInfo),t.originData.push(r)}catch(e){}})),t.use_mask&&t.destroyMask()}}))},G.prototype.restoreElements=function(){A.each(this.originData,(function(e){Y(e)})),this.visualExp=null,this.isFirst=!0,this.start_time=(new Date).getTime(),this.originData=[],this.isTrigger=!1},G.prototype.addSinglePageListener=function(){var e=this;A.addSinglePageEvent((function(t){if(t===location.href)return!1;e.mask_instance&&e.destroyMask(),e.start_time=(new Date).getTime(),e.use_mask&&e.initMask(),e.restoreElements(),e.resolve(e.SensorsABTest.originalData)}))},G.prototype.observerCallback=function(){this.visualExp&&(A.each(this.originData,(function(e){Y(e)})),this.originData=[],this.render(this.visualExp))},G.prototype.stopTrigger=function(){this.isFirst=!1,this.SensorsABTest.log("请求实验结果失败，A/B 可视化实验失败！"),this.use_mask&&this.destroyMask()},G.prototype.isTriggerVisualExp=function(e){return A.isString(e.control_link)&&A.isString(e.link_match_type)?!!A.checkUrlIsMatch(e.control_link,e.link_match_type)||(this.SensorsABTest.log("可视化试验匹配失败",e.abtest_experiment_id),!1):(this.SensorsABTest.log("可视化试验数据异常",e.abtest_experiment_id),!1)},ee.prototype.asyncFetchABTest=function(){A.error("asyncFetchABTest调用失败,A/B Testing未初始化")},ee.prototype.fastFetchABTest=function(){A.error("fastFetchABTest调用失败,A/B Testing未初始化")},ee.prototype.fetchCacheABTest=function(){A.error("fetchCacheABTest调用失败,A/B Testing未初始化")},ee.prototype.searchLocalExp=function(e){return this.localdata[e]?this.localdata[e]:null},ee.prototype.getExpResult=function(e,t){var s=e.default_value,r=t||this.searchLocalExp(e.param_name);return A.isObject(r)?A.isObject(r.js_config)&&(r.js_config.type===e.value_type?(s=r.js_config.value,this.triggerHandle(r,e)):this.log("试验结果类型与代码期望类型不一致，param_name："+e.param_name+"，当前返回类型为："+r.js_config.type+"，代码期望类型为："+e.value_type)):this.log("localdata未查询到试验数据，试验参数名称："+e.param_name),s},ee.prototype.resolveVariables=function(e){this.localdata={};var t=this;A.each(e,(function(e){if(A.isObject(e)&&e.variables&&A.isArray(e.variables)){if(e.experiment_type&&"CODE"!==e.experiment_type)return!1;A.each(e.variables,(function(s){A.isObject(s)&&!t.localdata[s.name]&&(t.localdata[s.name]={abtest_experiment_id:e.abtest_experiment_id,abtest_experiment_group_id:e.abtest_experiment_group_id,is_control_group:e.is_control_group,is_white_list:e.is_white_list,value:s.value,type:s.type,js_config:t.getRelativeValue(s.value,s.type),experiment_type:e.experiment_type})}))}}))},ee.prototype.getRelativeValue=function(e,t){var s=this,r={},i={INTEGER:function(e){var t=parseFloat(e);isNaN(t)?s.log("原始数据 INTEGER 类型解析异常",e):(r.value=t,r.type="Number")},STRING:function(e){A.isString(e)?(r.value=e,r.type="String"):s.log("原始数据 STRING 类型解析异常",e)},JSON:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=JSON.parse(e);A.isObject(t)?(r.value=t,r.type="Object"):s.log("原始数据 JSON 类型解析异常",e)})),BOOLEAN:function(e){"true"===e?(r.value=!0,r.type="Boolean"):"false"===e?(r.value=!1,r.type="Boolean"):s.log("原始数据 BOOLEAN 类型解析异常",e)}};try{i[t]?i[t](e):s.log("试验数据类型解析失败",t,e)}catch(r){s.log(r,e,t)}return r},ee.prototype.dealResponseData=function(e,t){A.isObject(e)?"SUCCESS"===e.status?A.isArray(e.results)&&(this.originalData=e.results,this.updateLocalData(e.results,t)):"FAILED"===e.status&&this.log("获取试验失败：error_type："+e.error_type+",error："+e.error):this.log("试验数据解析失败，response ：",e)},ee.prototype.updateLocalData=function(e,t){this.analyzeData(e),this.updateStorage(t),this.log("更新试验数据成功")},ee.prototype.updateStorage=function(e){var t=(new Date).getTime();R({data:this.originalData,updateTime:t,triggerList:this.triggerList,distinct_id:e||this.sd.store.getDistinctId()},this.state.storage.name,this.para.encrypt_cookie),this.updateTime=t},ee.prototype.analyzeData=function(e){if(!A.isArray(e))return this.log("解析——数据格式错误",e),!1;this.link.resolve(e),this.vabtest.resolve(e),this.resolveVariables(e)},ee.prototype.triggerHandle=function(e,t){var s=A.isObject(t)&&A.isObject(t.properties)?t.properties:{},r=this.trackTestTrigger(e,s),i=e.abtest_experiment_id;if(A.isString(i)){var n=this.sd.store.getDistinctId();this.triggerList[n]&&A.isArray(this.triggerList[n])?(this.triggerList[n].push(i),this.triggerList[n]=A.unique(this.triggerList[n])):this.triggerList[n]=[i],this.updateStorage()}return r},ee.prototype.trackTestTrigger=function(e,t){var s=this.sd.store.getDistinctId(),r=!0,i=!0;if(t=A.isObject(t)?t:{},!e.is_white_list){this.triggerList&&A.isObject(this.triggerList)&&("{}"!==JSON.stringify(this.triggerList)&&(i=!1),this.triggerList[s]&&A.isArray(this.triggerList[s])&&A.each(this.triggerList[s],(function(t){t===e.abtest_experiment_id&&(r=!1)})));var n={$abtest_experiment_id:e.abtest_experiment_id,$abtest_experiment_group_id:e.abtest_experiment_group_id};if(this.para.collect_bridge_status&&(n.$sdk_bridge_status=this.bridgeState),i){var a="web_abtesting:"+this.lib_version;n.$lib_plugin_version=[a]}var o=A.extend(n,t);return r&&this.sd.track("$ABTestTrigger",o),this.sd.track("WebABTestTrigger",o),r}},ee.prototype.checkSADebug=function(){var e=this,t=A.getQueryParam(location.href,"sensors_abtest_url"),s=A.getQueryParam(location.href,"feature_code"),r=+A.getQueryParam(location.href,"account_id");if(t.length&&s.length&&A.isNumber(r)&&0!==r){var i={distinct_id:this.sd.store.getDistinctId(),feature_code:s,account_id:r};this.sd._.ajax({url:t,type:"POST",data:JSON.stringify(i),credentials:!1,contentType:"application/json",timeout:this.para.timeout_milliseconds,cors:!0,success:function(){},error:function(t){e.log("distinct_id发送失败,err:",t)}})}},ee.prototype.initMethods=function(e){var t=this;A.each(["asyncFetchABTest","fastFetchABTest","fetchCacheABTest"],(function(s){t[s]=e.methods[s].bind(e)}))},te.prototype={timer:null,method:null,context:null,init:function(e,t){this.method=e,this.context=t,this.start(!0)},getServerData:function(e){var t=this;e?this.method.call(this.context,{suc:function(s){e&&("ab_bridge_ok"===t.SensorsABTest.bridgeState&&(s=s.data),A.isObject(s)&&"SUCCESS"===s.status&&A.isArray(s.results)||(t.SensorsABTest.link.stopTrigger(),t.SensorsABTest.vabtest.stopTrigger()))},err:function(){e&&(t.SensorsABTest.link.stopTrigger(),t.SensorsABTest.vabtest.stopTrigger())}}):this.method.call(this.context)},setNextFetch:function(e){var t=this,s=e||this.SensorsABTest.para.update_interval;this.clearFetchTimer(this.timer),this.timer=setTimeout((function(){t.getServerData()}),s)},start:function(e){var t=null,s=(new Date).getTime(),r=U(this.SensorsABTest.state.storage.name),i=this.SensorsABTest.sd.store.getDistinctId();if(r&&A.isObject(r)&&r.distinct_id===i)if(t=r.updateTime,e&&(this.SensorsABTest.originalData=r.data,t&&A.isNumber(t)&&s-t>0&&s-t<this.SensorsABTest.para.session_limit&&A.isObject(r.triggerList)&&(this.SensorsABTest.triggerList=r.triggerList),this.SensorsABTest.analyzeData(r.data)),t&&A.isNumber(t)&&s-t>0&&s-t<this.SensorsABTest.para.update_interval){this.SensorsABTest.log("数据不更新",t,s);var n=s-t,a=this.SensorsABTest.para.update_interval-n;this.setNextFetch(a)}else this.SensorsABTest.log("缓存数据超时",t,s),this.getServerData(e);else(t=this.SensorsABTest.updateTime)&&A.isNumber(t)&&s-t>0&&s-t<this.SensorsABTest.para.update_interval?this.SensorsABTest.log("数据不更新",t,s):this.getServerData(e)},stop:function(){this.SensorsABTest.log("清空拉取定时器"),this.clearFetchTimer()},clearFetchTimer:function(){clearTimeout(this.timer),this.timer=null}},re.prototype={init:function(e,t){var s=this;this.SensorsABTest.fetchData.init(e,t),this.SensorsABTest.initMethods(t),function(e){({visibleHandle:A.isFunction(e.visible)?e.visible:function(){},hiddenHandler:A.isFunction(e.hidden)?e.hidden:function(){},visibilityChange:null,hidden:null,isSupport:function(){return void 0!==document[this.hidden]},init:function(){void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen:function(){if(this.isSupport()){var e=this;document.addEventListener(e.visibilityChange,(function(){document[e.hidden]?e.hiddenHandler():e.visibleHandle()}),1)}else document.addEventListener?(window.addEventListener("focus",this.visibleHandle,1),window.addEventListener("blur",this.hiddenHandler,1)):(document.attachEvent("onfocusin",this.visibleHandle),document.attachEvent("onfocusout",this.hiddenHandler))}}).init()}({visible:function(){s.SensorsABTest.log("页面显示"),s.SensorsABTest.fetchData.start()},hidden:function(){s.SensorsABTest.fetchData.stop()}}),this.SensorsABTest.sd.events.on("changeDistinctId",(function(e){s.SensorsABTest.localdata={},s.SensorsABTest.originalData=[],s.SensorsABTest.vabtest.restoreElements(),s.SensorsABTest.updateStorage(),s.SensorsABTest.fetchData.getServerData()})),this.SensorsABTest.sd.events.isReady()}},ee.prototype.init=function(e,t){return this.sd?(this.log("A/B Testing SDK 重复初始化！只有第一次初始化有效！"),!1):function(e){return A.isObject(e)&&A.isObject(e.readyState)&&e.readyState.state>=3?e:null}(e)?(this.sd=e,A.isObject(t)?(A.storage.isSupport()||this.log("localstorage异常"),this.abtestingPara=t,this.fetchData=new te(this),this.store=new re(this),void this.initTest()):(this.log("A/B Testing SDK 初始化失败，请传入正确的初始化参数!para:",t),!1)):(this.log("A/B Testing 初始化失败,Web JS SDK 没有初始化完成"),!1)},ee.prototype.initTest=function(){this.link.init(this.abtestingPara.multilink),this.vabtest.init(this.abtestingPara.visualize),this.sd.bridge.is_verify_success?this.bridgeStore.init(this.abtestingPara):this.normalStore.init(this.abtestingPara)},ee.prototype.log=function(){return A.isString(arguments[0])&&(arguments[0]="sensorsabtest————"+arguments[0]),this.sd&&this.sd.log.apply(this,arguments)};var ie=new ee;ie.__constructor__=ee,window.SensorsDataWebJSSDKPlugin&&"[object Object]"==Object.prototype.toString.call(window.SensorsDataWebJSSDKPlugin)?window.SensorsDataWebJSSDKPlugin.SensorsABTest=window.SensorsDataWebJSSDKPlugin.SensorsABTest||ie:window.SensorsDataWebJSSDKPlugin={SensorsABTest:ie};var ne,ae,se,oe,ce,le,ue=ee,pe={env:_.a,app_id:1e4,notify_lang:Object(h.b)(v.b)||f.a.get(v.b)||window.navigator.language,project_type:"",project_name:"",ga_id:function(){if(window.ga){var e=window.ga.getAll&&window.ga.getAll()||[];if(e.length)return e[0].get("clientId")}var t=Object(h.b)("_ga");return t?t.slice(6):"none client id"}(),page_url:window.location.href||"",page_path:window.location.pathname||"",referrer_url:document.referrer||"",referrer_path:function(){if(!document.referrer)return"";if(window.URL)return new URL(document.referrer).pathname;var e=document.createElement("a");return e.href=document.referrer,e.pathname}(),tdid:f.a.get("BYBIT_TDID_V2")||"",guid:(le=Object(h.b)(v.a),le&&36===le.length||(le=Object(w.a)()),Object(h.a)(v.a,le,-1!==(ce=window.location.host).indexOf("localhost")?"localhost":ce.replace(/^(www|m|testnet|blog-test|blog|learn|announcements)/,""),"/",172800),le),u:window.GA_UID||"",platform_type:(ne=navigator.userAgent,ae=/(?:Android)/.test(ne),se=/(?:Firefox)/.test(ne),oe=/(?:iPad|PlayBook)/.test(ne)||ae&&!/(?:Mobile)/.test(ne)||se&&/(?:Tablet)/.test(ne),/(?:iPhone)/.test(ne)&&!oe||ae?"H5":"Web"),dx_id:Object(h.b)("35CJa4376")||"",dx_cp:Object(h.b)("35CJa4376-cp")||"",user_agent:window.navigator.userAgent||""},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoUTM:!1,heatmap:{},abUrl:"",abProjectName:""},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(d.a)(e)&&e.server_url&&(l.a.init(Object(n.a)({is_track_single_page:!0,send_type:"beacon",web_url:"https://sc-web.ffe390afd658c19dcbf707e0597b846d.de?project=".concat(_.b?"production":"default"),heatmap:Object(n.a)({clickmap:"default",scroll_notice_map:"default"},e.heatmap),app_js_bridge:!0},e)),Object(d.a)(t)&&(l.a.registerPage(Object(n.a)(Object(n.a)({},pe),t)),e.autoUTM&&Object(y.a)(l.a)),l.a.quick("autoTrack"),e.abUrl&&e.abProjectName&&l.a.use(e.abProjectName,{url:e.abUrl}))},he=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{autoUTM:!1,heatmap:{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Object(d.a)(t)||!t.server_url)return null;var o=T(e);return o.init(Object(n.a)({is_track_single_page:!0,send_type:"beacon",web_url:"https://sc-web.ffe390afd658c19dcbf707e0597b846d.de?project=".concat(_.b?"production":"default"),heatmap:Object(n.a)({clickmap:"default",scroll_notice_map:"default"},t.heatmap)},t)),Object(d.a)(r)&&(o.registerPage(Object(n.a)(Object(n.a)({},pe),r)),t.autoUTM&&Object(y.a)(o)),t.shouldNotCollectionPageView||o.quick("autoTrack"),o};t.b=l.a}}]);